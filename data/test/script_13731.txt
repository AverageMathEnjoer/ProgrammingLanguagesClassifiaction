b'context("interactions")\ntest_that("interactions throw error", {\n  dds <- makeExampleDESeqDataSet(n=100,m=8)\n  colData(dds)$group <- factor(rep(c("X","Y"),times=ncol(dds)/2))\n  design(dds) <- ~ condition + group + condition:group\n  dds <- DESeq(dds)\n  expect_equal(resultsNames(dds)[4], "conditionB.groupY")\n\n  # interactions error\n  expect_error(DESeq(dds, betaPrior=TRUE), "designs with interactions")\n\n  # also lfcShrink\n  res <- results(dds, name="conditionB.groupY")\n  expect_error(res <- lfcShrink(dds, coef=4,\n                                res=res, type="normal"),\n               "not implemented")\n\n  res <- results(dds, contrast=c("condition","B","A"))\n  expect_error(res <- lfcShrink(dds, contrast=c("condition","B","A"),\n                                res=res, type="normal"),\n               "not implemented")\n  \n  # however, this is allowed...\n  dds2 <- dds\n  design(dds2) <- model.matrix(~ condition + group + condition:group, colData(dds))\n  dds2 <- DESeq(dds2)\n  res2 <- results(dds2, name="conditionB.groupY")\n  res2 <- lfcShrink(dds2, coef=4, res=res, type="normal")\n\n})\n'