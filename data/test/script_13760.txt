b'\xef\xbb\xbf//  Copyright 2019 Google Inc. All Rights Reserved.\n//\n//  Licensed under the Apache License, Version 2.0 (the "License");\n//  you may not use this file except in compliance with the License.\n//  You may obtain a copy of the License at\n//\n//  http://www.apache.org/licenses/LICENSE-2.0\n//\n//  Unless required by applicable law or agreed to in writing, software\n//  distributed under the License is distributed on an "AS IS" BASIS,\n//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n//  See the License for the specific language governing permissions and\n//  limitations under the License.\n\nusing Rubeus.Win32.Rpc;\n\nnamespace Rubeus.Ndr.Marshal\n{\n    /// <summary>\n    /// Class to represent an NDR interface pointer.\n    /// </summary>\n    public struct NdrInterfacePointer : INdrConformantStructure\n    {\n        /// <summary>\n        /// The marshaled interface data.\n        /// </summary>\n        public byte[] Data { get; set; }\n\n        /// <summary>\n        /// Constructor.\n        /// </summary>\n        /// <param name="data">The marshaled interface data.</param>\n        public NdrInterfacePointer(byte[] data)\n        {\n            Data = data;\n        }\n\n        int INdrConformantStructure.GetConformantDimensions()\n        {\n            return 1;\n        }\n\n        void INdrStructure.Marshal(NdrMarshalBuffer marshal)\n        {\n            RpcUtils.CheckNull(Data, "Data");\n            marshal.WriteInt32(Data.Length);\n            marshal.WriteConformantByteArray(Data, Data.Length);\n        }\n\n        void INdrStructure.Unmarshal(NdrUnmarshalBuffer unmarshal)\n        {\n            unmarshal.ReadInt32(); // length.\n            Data = unmarshal.ReadConformantByteArray();\n        }\n\n        int INdrStructure.GetAlignment()\n        {\n            return 4;\n        }\n    }\n}\n'