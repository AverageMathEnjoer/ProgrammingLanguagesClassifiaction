b'-- |\n-- Module      : Hoodle.ModelAction.Adjustment\n-- Copyright   : (c) 2011,2012,2014 Ian-Woo Kim\n--\n-- License     : BSD3\n-- Maintainer  : Ian-Woo Kim <ianwookim@gmail.com>\n-- Stability   : experimental\n-- Portability : GHC\nmodule Hoodle.ModelAction.Adjustment where\n\nimport qualified Data.Foldable as F (mapM_)\nimport Data.Hoodle.BBox (BBox (..))\nimport Data.Hoodle.Simple (Dimension (..))\nimport qualified Graphics.UI.Gtk as Gtk\nimport Hoodle.Type.PageArrangement\n  ( DesktopDimension (..),\n    ViewPortBBox (..),\n  )\nimport Hoodle.View.Coordinate\n  ( CanvasGeometry,\n    canvasViewPort,\n    desktopDim,\n  )\n\n-- | adjust values, upper limit and page size according to canvas geometry\nadjustScrollbarWithGeometry ::\n  CanvasGeometry ->\n  ( (Gtk.Adjustment, Maybe (Gtk.ConnectId Gtk.Adjustment)),\n    (Gtk.Adjustment, Maybe (Gtk.ConnectId Gtk.Adjustment))\n  ) ->\n  IO ()\nadjustScrollbarWithGeometry geometry ((hadj, mconnidh), (vadj, mconnidv)) = do\n  let DesktopDimension (Dim w h) = desktopDim geometry\n      ViewPortBBox (BBox (x0, y0) (x1, y1)) = canvasViewPort geometry\n      xsize = x1 - x0\n      ysize = y1 - y0\n  F.mapM_ Gtk.signalBlock mconnidh\n  F.mapM_ Gtk.signalBlock mconnidv\n  Gtk.adjustmentSetUpper hadj w\n  Gtk.adjustmentSetUpper vadj h\n  Gtk.adjustmentSetValue hadj x0\n  Gtk.adjustmentSetValue vadj y0\n  Gtk.adjustmentSetPageSize hadj xsize -- (min xsize w)\n  Gtk.adjustmentSetPageSize vadj ysize --  (min ysize h)\n  Gtk.adjustmentSetPageIncrement hadj (xsize * 0.9)\n  Gtk.adjustmentSetPageIncrement vadj (ysize * 0.9)\n  F.mapM_ Gtk.signalUnblock mconnidh\n  F.mapM_ Gtk.signalUnblock mconnidv\n\n-- |\nsetAdjustments ::\n  ( (Gtk.Adjustment, Maybe (Gtk.ConnectId Gtk.Adjustment)),\n    (Gtk.Adjustment, Maybe (Gtk.ConnectId Gtk.Adjustment))\n  ) ->\n  (Double, Double) ->\n  (Double, Double) ->\n  (Double, Double) ->\n  (Double, Double) ->\n  IO ()\nsetAdjustments\n  ((hadj, mconnidh), (vadj, mconnidv))\n  (upperx, uppery)\n  (lowerx, lowery)\n  (valuex, valuey)\n  (pagex, pagey) = do\n    F.mapM_ Gtk.signalBlock mconnidh\n    F.mapM_ Gtk.signalBlock mconnidv\n    Gtk.adjustmentSetUpper hadj upperx\n    Gtk.adjustmentSetUpper vadj uppery\n    Gtk.adjustmentSetLower hadj lowerx\n    Gtk.adjustmentSetLower vadj lowery\n    Gtk.adjustmentSetValue hadj valuex\n    Gtk.adjustmentSetValue vadj valuey\n    Gtk.adjustmentSetPageSize hadj pagex\n    Gtk.adjustmentSetPageSize vadj pagey\n    F.mapM_ Gtk.signalUnblock mconnidh\n    F.mapM_ Gtk.signalUnblock mconnidv\n'