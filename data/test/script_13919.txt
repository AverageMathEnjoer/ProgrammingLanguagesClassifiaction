b'context("DESeq")\ntest_that("DESeq() gives correct errors", {\n  dds <- makeExampleDESeqDataSet(n=100, m=8)\n  expect_error(DESeq(dds, test="LRT"))\n  expect_error(DESeq(dds, test="Wald", full=~condition, reduced=~1))\n  expect_error(DESeq(dds, full=~1))\n  \n  m <- model.matrix(~ condition, colData(dds))\n  expect_error(DESeq(dds, test="LRT", full=m, reduced=~1))\n  expect_error(DESeq(dds, test="LRT", full=m, reduced=m))\n  expect_error(DESeq(dds, full=m, betaPrior=TRUE))\n  \n  design(dds) <- ~ 0 + condition\n  expect_error(DESeq(dds, betaPrior=TRUE))\n  \n  dds <- makeExampleDESeqDataSet(n=100)\n  dds$condition <- factor(rep(c("A","B","C"),each=4))\n  dds <- dds[,1:8]\n  expect_error(DESeq(dds))\n})\n'