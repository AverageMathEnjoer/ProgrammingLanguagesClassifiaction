b'\xef\xbb\xbfusing Asn1;\nusing System.Security.Cryptography.X509Certificates;\n\nnamespace Rubeus {\n    public class KrbAuthPack {\n\n        public KrbPkAuthenticator Authenticator { get; private set; }\n        public KrbSubjectPublicKeyInfo ClientPublicValue { get; set; }\n        public KrbAlgorithmIdentifier[] SupportedCMSTypes { get; set; }\n        public byte[] ClientDHNonce { get; set; }\n        public X509Certificate2 Certificate { get; set; }\n\n        public KrbAuthPack(KrbPkAuthenticator authenticator, X509Certificate2 certificate) {\n            Authenticator = authenticator;\n            Certificate = certificate;\n            ClientDHNonce = new byte[0];\n        }\n\n        public AsnElt Encode() {\n          \n            return AsnElt.Make(AsnElt.SEQUENCE, \n                new AsnElt[] {\n                    AsnElt.Make(AsnElt.CONTEXT,0, Authenticator.Encode()),\n                    AsnElt.Make(AsnElt.CONTEXT,1, ClientPublicValue.Encode() ),\n                    //AsnElt.Make(AsnElt.CONTEXT,2, new AsnElt[]{ CMSTypes } ),\n                    AsnElt.Make(AsnElt.CONTEXT,3, AsnElt.MakeBlob(ClientDHNonce)) \n                });\n        }\n    }\n}\n'