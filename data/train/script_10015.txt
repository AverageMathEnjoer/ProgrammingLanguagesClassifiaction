b'\xef\xbb\xbfusing System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Linq;\nusing System.Text;\nusing Rubeus.Ndr;\nusing Rubeus.Ndr.Marshal;\n\nnamespace Rubeus.Kerberos.PAC {\n    public class S4UDelegationInfo : PacInfoBuffer {\n\n        public _S4U_DELEGATION_INFO s4u { get; set; }\n\n        public S4UDelegationInfo() {\n            Type = PacInfoBufferType.S4U2Proxy;\n            s4u = _S4U_DELEGATION_INFO.CreateDefault();\n        }\n\n        public S4UDelegationInfo(string s4uProxyTarget, string[] s4uTransitedServices)\n        {\n            Type = PacInfoBufferType.S4U2Proxy;\n            _RPC_UNICODE_STRING[] tmp = new _RPC_UNICODE_STRING[s4uTransitedServices.Length];\n            int c = 0;\n            foreach (string s4uTransitedService in s4uTransitedServices)\n            {\n                tmp[c] = new _RPC_UNICODE_STRING(s4uTransitedService);\n                c += 1;\n            }\n            s4u = new _S4U_DELEGATION_INFO(new _RPC_UNICODE_STRING(s4uProxyTarget), s4uTransitedServices.Length, tmp);\n        }\n\n        public S4UDelegationInfo(_S4U_DELEGATION_INFO s4uInfo) : this()\n        {\n            s4u = s4uInfo;\n        }\n\n        public S4UDelegationInfo(byte[] data) : base(data, PacInfoBufferType.S4U2Proxy) {\n            Decode(data);\n        }\n\n        protected override void Decode(byte[] data) {\n            NdrPickledType npt = new NdrPickledType(data);\n            _Unmarshal_Helper uh = new _Unmarshal_Helper(npt.Data);\n            s4u = (_S4U_DELEGATION_INFO)uh.ReadReferentValue(uh.ReadStruct<_S4U_DELEGATION_INFO>, false);\n        }\n\n        public override byte[] Encode() {\n            _Marshal_Helper mh = new _Marshal_Helper();\n            mh.WriteReferent(s4u, new Action<_S4U_DELEGATION_INFO>(mh.WriteStruct));\n            return mh.ToPickledType().ToArray();           \n        }   \n    }\n}\n'