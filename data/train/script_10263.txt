b'context("addMLE")\ntest_that("adding MLE works as expected", {\n  set.seed(1)\n  dds <- makeExampleDESeqDataSet(n=200,m=12,betaSD=1)\n  dds$condition <- factor(rep(letters[1:3],each=4))\n  dds <- DESeq(dds, betaPrior=TRUE)\n  ddsNP <- nbinomWaldTest(dds, betaPrior=FALSE)\n\n  res1 <- results(dds, contrast=c("condition","c","a"), addMLE=TRUE)\n  res2 <- results(ddsNP, contrast=c("condition","c","a"))\n  expect_equal(res1$lfcMLE, res2$log2FoldChange)\n\n  res1 <- results(dds, contrast=c("condition","a","b"), addMLE=TRUE)\n  res2 <- results(ddsNP, contrast=c("condition","a","b"))\n  expect_equal(res1$lfcMLE, res2$log2FoldChange)\n\n  res1 <- results(dds, contrast=c("condition","c","b"), addMLE=TRUE)\n  res2 <- results(ddsNP, contrast=c("condition","c","b"))\n  expect_equal(res1$lfcMLE, res2$log2FoldChange)\n})\n'