b'/*Copyright \xc2\xa9  2017 Lyons. All rights reserved. */\npackage lyons.core.shiro.token;\n\nimport org.apache.shiro.SecurityUtils;\nimport org.apache.shiro.authc.UsernamePasswordToken;\n\nimport lyons.common.exception.user.UserException;\nimport lyons.common.model.user.UUser;\nimport lyons.common.utils.MathUtil;\nimport lyons.common.utils.VisitorUtil;\n\n/**\n * @Description: Token\xe7\xae\xa1\xe7\x90\x86\xe5\xb7\xa5\xe5\x85\xb7\xe7\xb1\xbb\n * @ClassName: TokenManager\n * @author: lyons<zhanglei>\n * @date: 2017\xe5\xb9\xb41\xe6\x9c\x8818\xe6\x97\xa5 \xe4\xb8\x8b\xe5\x8d\x885:19:55\n * @version: [1.0]\n */\npublic class TokenManager\n{\n    \n    /**\n     * \n     * @Title: login\n     * @Description: shiro \xe7\x99\xbb\xe5\xbd\x95 (\xe5\xaf\x86\xe7\xa0\x81md5\xe5\xb0\x81\xe8\xa3\x85\xe5\x8a\xa0\xe5\xaf\x86)\n     * @param uuser\n     * @param rememberMe\n     * @return: \n     */\n    public static void login(UUser uuser) throws UserException\n    {\n        if (VisitorUtil.isSecurity(uuser))\n        {\n            UsernamePasswordToken token = \n                new UsernamePasswordToken(uuser.getuName(),MathUtil.getCharMd5(uuser.getuPassword()));\n//        token.setRememberMe(true);//\xe9\xbb\x98\xe8\xae\xa4\xe8\xae\xb0\xe4\xbd\x8f\xe7\x99\xbb\xe5\xbd\x95\n            SecurityUtils.getSubject().login(token);\n        }\n        \n    }\n    \n    /**\n     * \n     * @Title: getToken\n     * @Description:\xe8\x8e\xb7\xe5\x8f\x96\xe5\xbd\x93\xe5\x89\x8d\xe7\x99\xbb\xe5\xbd\x95\xe7\x94\xa8\xe6\x88\xb7\xe7\x9a\x84user\xe5\xaf\xb9\xe8\xb1\xa1\n     * @return\n     * @return: UUser\n     */\n    public static UUser getToken()\n    {\n        return (UUser)SecurityUtils.getSubject().getPrincipal();\n    }\n\n    /**\n     * @Title: logout\n     * @Description: \xe8\xb4\xa6\xe6\x88\xb7\xe9\x80\x80\xe5\x87\xba\n     * @return: void\n     */\n    public static void logout()\n    {\n        if (VisitorUtil.isLogin())\n        {\n            SecurityUtils.getSubject().logout();\n        }\n    }\n    \n}\n'