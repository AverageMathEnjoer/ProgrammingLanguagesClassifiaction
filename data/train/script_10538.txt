b'makeSim <- function(n, m, x, beta, meanDispPairs, sf=rep(1,m)) {\n  idx <- sample(nrow(meanDispPairs), n, replace=TRUE)\n  mu0 <- meanDispPairs[idx,1]\n  disp <- meanDispPairs[idx,2]\n  betafull <- cbind(log2(mu0), beta)\n  mu <- 2^(betafull %*% t(x))\n  swap <- sort(sample(n, n/2, replace=FALSE))\n  mu[swap,] <- mu[swap,c((m/2+1):m,1:(m/2))]\n  beta[swap] <- -1 * beta[swap]\n  muMat <- matrix(rep(mu, times=m) * rep(sf, each=n), ncol=m)\n  list(mat = matrix(rnbinom(n*m, mu=muMat, size=1/disp), ncol=m),\n       beta = beta,\n       disp = disp,\n       mu0 = mu0)\n}\n'