b'\xef\xbb\xbfusing System.Diagnostics;\nusing System.Text;\n\nnamespace XboxDownload\n{\n    public partial class FormStartup : Form\n    {\n        public FormStartup()\n        {\n            InitializeComponent();\n            if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.System) + @"\\Tasks\\" + Form1.appName))\n            {\n                cbStartup.Checked = true;\n            }\n        }\n\n        private void ButSubmit_Click(object sender, EventArgs e)\n        {\n            butSubmit.Enabled = false;\n\n            if (cbStartup.Checked)\n            {\n                string taskPath = Path.GetTempPath() + "XboxDownloadTask.xml";\n                string xml = String.Format(Properties.Resource.Task, Application.ExecutablePath);\n                File.WriteAllText(taskPath, xml, Encoding.GetEncoding("UTF-16"));\n                string cmdPath = Path.GetTempPath() + "\\\\XboxDownloadTask.cmd";\n                string cmd = "chcp 65001\\r\\nschtasks /create /xml \\"" + taskPath + "\\" /tn \\"" + Form1.appName + "\\" /f";\n                File.WriteAllText(cmdPath, cmd);\n                using (Process p = new())\n                {\n                    p.StartInfo.FileName = "cmd.exe";\n                    p.StartInfo.UseShellExecute = false;\n                    p.StartInfo.CreateNoWindow = true;\n                    p.StartInfo.Arguments = "/c \\"" + cmdPath + "\\"";\n                    p.Start();\n                    p.WaitForExit();\n                }\n                File.Delete(cmdPath);\n                File.Delete(taskPath);\n            }\n            else\n            {\n                string cmdPath = Path.GetTempPath() + "XboxDownloadTask.cmd";\n                string cmd = "chcp 65001\\r\\nschtasks /delete /tn \\"" + Form1.appName + "\\" /f\\r\\nschtasks /delete /tn \\"XboxDownload\\" /f";\n                File.WriteAllText(cmdPath, cmd);\n                using (Process p = new())\n                {\n                    p.StartInfo.FileName = "cmd.exe";\n                    p.StartInfo.UseShellExecute = false;\n                    p.StartInfo.CreateNoWindow = true;\n                    p.StartInfo.Arguments = "/c \\"" + cmdPath + "\\"";\n                    p.Start();\n                    p.WaitForExit();\n                }\n                File.Delete(cmdPath);\n            }\n            this.Close();\n        }\n    }\n}\n'