b'-- The Smallest Free Number\n\n-- Array-based Solution\n\nimport Data.List\n\nminfree :: [Integer] -> Integer\n\nminfree xs = minfrom 0 (toInteger (length xs), xs)\n\nminfrom :: Integer -> (Integer, [Integer]) -> Integer\n\nminfrom a (n, xs)   | n == 0        = a\n                    | m == b - a    = minfrom b (n - m, vs)\n                    | otherwise     = minfrom a (m, us)\n                      where (us, vs)    = partition (< b) xs\n                            b           = a + 1 + n `div` 2\n                            m           = toInteger (length us)\n\n'