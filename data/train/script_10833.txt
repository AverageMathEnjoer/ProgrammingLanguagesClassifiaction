b'\xef\xbb\xbf// UVa512 Spreadsheet Tracking (\xe7\xae\x97\xe6\xb3\x952)\n// Rujia Liu\n#include<stdio.h>\n#include<string.h>\n#define maxd 10000\n\nstruct Command {\n  char c[5];\n  int r1, c1, r2, c2;\n  int a, x[20];\n} cmd[maxd];\nint r, c, n;\n\nint simulate(int* r0, int* c0) {\n  for(int i = 0; i < n; i++) {\n    if(cmd[i].c[0] == \'E\') {\n       if(cmd[i].r1 == *r0 && cmd[i].c1 == *c0) { *r0 = cmd[i].r2; *c0 = cmd[i].c2; }\n       else if(cmd[i].r2 == *r0 && cmd[i].c2 == *c0) { *r0 = cmd[i].r1; *c0 = cmd[i].c1; }\n    } else {\n      int dr = 0, dc = 0;\n      for(int j = 0; j < cmd[i].a; j++) {\n        int x = cmd[i].x[j];\n        if(cmd[i].c[0] == \'I\') {\n          if(cmd[i].c[1] == \'R\' && x <= *r0) dr++;\n          if(cmd[i].c[1] == \'C\' && x <= *c0) dc++;\n        }\n        else {\n          if(cmd[i].c[1] == \'R\' && x == *r0) return 0;\n          if(cmd[i].c[1] == \'C\' && x == *c0) return 0;\n          if(cmd[i].c[1] == \'R\' && x < *r0) dr--;\n          if(cmd[i].c[1] == \'C\' && x < *c0) dc--;\n        }\n      }\n      *r0 += dr; *c0 += dc;      \n    }\n  }\n  return 1;\n}\n\nint main() {\n  int r0, c0, q, kase = 0;\n  while(scanf("%d%d%d", &r, &c, &n) == 3 && r) {\n    for(int i = 0; i < n; i++) {\n      scanf("%s", cmd[i].c);\n      if(cmd[i].c[0] == \'E\') {\n        scanf("%d%d%d%d", &cmd[i].r1, &cmd[i].c1, &cmd[i].r2, &cmd[i].c2);\n      } else {\n        scanf("%d", &cmd[i].a);\n        for(int j = 0; j < cmd[i].a; j++) scanf("%d", &cmd[i].x[j]);\n      }\n    }\n    if(kase > 0) printf("\\n");\n    printf("Spreadsheet #%d\\n", ++kase);\n\n    scanf("%d", &q);\n    while(q--) {\n      scanf("%d%d", &r0, &c0);\n      printf("Cell data in (%d,%d) ", r0, c0);\n      if(!simulate(&r0, &c0)) printf("GONE\\n");\n      else printf("moved to (%d,%d)\\n", r0, c0);\n    }\n  }\n  return 0;\n}\n'