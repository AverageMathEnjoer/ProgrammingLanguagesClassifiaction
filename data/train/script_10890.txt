b'\xef\xbb\xbfusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Business.Abstract;\nusing Entities.Dtos;\nusing Microsoft.AspNetCore.Mvc;\n\nnamespace WebAPI.Controllers\n{\n    [Route("api/[controller]")]\n    [ApiController]\n    public class AuthController:Controller\n    {\n        private IAuthService _authService;\n\n        public AuthController(IAuthService authService)\n        {\n            _authService = authService;\n        }\n\n        [HttpPost("login")]\n        public ActionResult Login(UserForLoginDto userForLoginDto)\n        {\n            var userToLogin = _authService.Login(userForLoginDto);\n            if (!userToLogin.Success)\n            {\n                return BadRequest(userToLogin.Message);\n            }\n\n            var result = _authService.CreateAccessToken(userToLogin.Data);\n            if (result.Success)\n            {\n                return Ok(result.Data);\n            }\n\n            return BadRequest(result.Message);\n        }\n\n        [HttpPost("register")]\n        public ActionResult Register(UserForRegisterDto userForRegisterDto)\n        {\n            var userExists = _authService.UserExists(userForRegisterDto.Email);\n            if (!userExists.Success)\n            {\n                return BadRequest(userExists.Message);\n            }\n\n            var registerResult = _authService.Register(userForRegisterDto,userForRegisterDto.Password);\n            var result = _authService.CreateAccessToken(registerResult.Data);\n            if (result.Success)\n            {\n                return Ok(result.Data);\n            }\n\n            return BadRequest(result.Message);\n        }\n    }\n}\n'