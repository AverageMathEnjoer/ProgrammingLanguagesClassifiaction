b'package io.github.javiewer.fragment;\n\n\nimport android.os.Bundle;\nimport androidx.annotation.Nullable;\nimport androidx.swiperefreshlayout.widget.SwipeRefreshLayout;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport java.util.List;\n\nimport io.github.javiewer.adapter.MovieAdapter;\nimport io.github.javiewer.adapter.item.Movie;\nimport io.github.javiewer.network.provider.AVMOProvider;\nimport io.github.javiewer.view.decoration.MovieItemDecoration;\nimport io.github.javiewer.view.listener.EndlessOnScrollListener;\nimport jp.wasabeef.recyclerview.adapters.SlideInBottomAnimationAdapter;\nimport jp.wasabeef.recyclerview.animators.SlideInUpAnimator;\nimport okhttp3.ResponseBody;\nimport retrofit2.Call;\n\npublic abstract class MovieFragment extends RecyclerFragment<Movie, LinearLayoutManager> {\n\n    public MovieFragment() {\n        // Required empty public constructor\n    }\n\n    @Override\n    public void onActivityCreated(@Nullable Bundle savedInstanceState) {\n        this.setLayoutManager(new LinearLayoutManager(this.getContext()));\n        mRecyclerView.addItemDecoration(new MovieItemDecoration());\n        this.setAdapter(new SlideInBottomAnimationAdapter(new MovieAdapter(getItems(), this.getActivity())));\n        RecyclerView.ItemAnimator animator = new SlideInUpAnimator();\n        animator.setAddDuration(300);\n        mRecyclerView.setItemAnimator(animator);\n\n        this.setOnRefreshListener(new SwipeRefreshLayout.OnRefreshListener() {\n            @Override\n            public void onRefresh() {\n                getOnScrollListener().refresh();\n            }\n        });\n\n        this.addOnScrollListener(new EndlessOnScrollListener<Movie>() {\n            @Override\n            public Call<ResponseBody> newCall(int page) {\n                return MovieFragment.this.newCall(page);\n            }\n\n            @Override\n            public RecyclerView.LayoutManager getLayoutManager() {\n                return MovieFragment.this.getLayoutManager();\n            }\n\n            @Override\n            public SwipeRefreshLayout getRefreshLayout() {\n                return MovieFragment.this.mRefreshLayout;\n            }\n\n            @Override\n            public List<Movie> getItems() {\n                return MovieFragment.this.getItems();\n            }\n\n            @Override\n            public RecyclerView.Adapter getAdapter() {\n                return MovieFragment.this.getAdapter();\n            }\n\n            @Override\n            public void onResult(ResponseBody response) throws Exception {\n                super.onResult(response);\n                List<Movie> wrappers = AVMOProvider.parseMovies(response.string());\n\n                int pos = getItems().size();\n\n                getItems().addAll(wrappers);\n                getAdapter().notifyItemRangeInserted(pos, wrappers.size());\n            }\n        });\n\n        mRefreshLayout.post(new Runnable() {\n            @Override\n            public void run() {\n                mRefreshLayout.setRefreshing(true);\n                getOnRefreshListener().onRefresh();\n            }\n        });\n\n        super.onActivityCreated(savedInstanceState);\n    }\n\n    public abstract Call<ResponseBody> newCall(int page);\n}\n'