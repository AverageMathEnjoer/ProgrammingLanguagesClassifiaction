b'\xef\xbb\xbfusing System;\nusing Asn1;\n\nnamespace Rubeus\n{\n    public class ADKerbLocal : AuthorizationData\n    {\n        public byte[] LocalData { get; set; }\n\n        public ADKerbLocal()\n        {\n            ad_type = Interop.AuthorizationDataType.KERB_LOCAL;\n\n            // random KERB-LOCAL\n            var rand = new Random();\n            byte[] randomBytes = new byte[16];\n            rand.NextBytes(randomBytes);\n            ad_data = randomBytes;\n        }\n        public ADKerbLocal(byte[] data)\n        {\n            ad_type = Interop.AuthorizationDataType.KERB_LOCAL;\n            ad_data = data;\n        }\n\n        public ADKerbLocal(AsnElt data)\n        {\n            Decode(data);\n        }\n\n        protected override void Decode(AsnElt data, byte[] junk = null)\n        {\n            Decode(data);\n        }\n\n        protected override void Decode(AsnElt data)\n        {\n            foreach (AsnElt s in data.Sub)\n            {\n                switch (s.TagValue)\n                {\n                    case 0:\n                        ad_type = (Interop.AuthorizationDataType)s.Sub[0].GetInteger();\n                        break;\n                    case 1:\n                        ad_data = s.Sub[0].GetOctetString();\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n\n        public override AsnElt Encode()\n        {\n            return ADEncode();\n        }\n    }\n}\n\n'