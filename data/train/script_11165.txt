b'package com.ethanhua.skeleton;\n\nimport android.util.Log;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\n\n/**\n * Created by ethanhua on 2017/8/2.\n */\n\npublic class ViewReplacer {\n    private static final String TAG = ViewReplacer.class.getName();\n    private final View mSourceView;\n    private View mTargetView;\n    private int mTargetViewResID = -1;\n    private View mCurrentView;\n    private ViewGroup mSourceParentView;\n    private final ViewGroup.LayoutParams mSourceViewLayoutParams;\n    private int mSourceViewIndexInParent = 0;\n    private final int mSourceViewId;\n\n    public ViewReplacer(View sourceView) {\n        mSourceView = sourceView;\n        mSourceViewLayoutParams = mSourceView.getLayoutParams();\n        mCurrentView = mSourceView;\n        mSourceViewId = mSourceView.getId();\n    }\n\n\n    public void replace(int targetViewResID) {\n        if (mTargetViewResID == targetViewResID) {\n            return;\n        }\n        if (init()) {\n            mTargetViewResID = targetViewResID;\n            replace(LayoutInflater.from(mSourceView.getContext()).inflate(mTargetViewResID, mSourceParentView, false));\n        }\n    }\n\n    public void replace(View targetView) {\n        if (mCurrentView == targetView) {\n            return;\n        }\n        if (targetView.getParent() != null) {\n            ((ViewGroup) targetView.getParent()).removeView(targetView);\n        }\n        if (init()) {\n            mTargetView = targetView;\n            mSourceParentView.removeView(mCurrentView);\n            mTargetView.setId(mSourceViewId);\n            mSourceParentView.addView(mTargetView, mSourceViewIndexInParent, mSourceViewLayoutParams);\n            mCurrentView = mTargetView;\n        }\n    }\n\n    public void restore() {\n        if (mSourceParentView != null) {\n            mSourceParentView.removeView(mCurrentView);\n            mSourceParentView.addView(mSourceView, mSourceViewIndexInParent, mSourceViewLayoutParams);\n            mCurrentView = mSourceView;\n            mTargetView = null;\n            mTargetViewResID = -1;\n        }\n    }\n\n\n    public View getSourceView() {\n        return mSourceView;\n    }\n\n    public View getTargetView() {\n        return mTargetView;\n    }\n\n    public View getCurrentView() {\n        return mCurrentView;\n    }\n\n    private boolean init() {\n        if (mSourceParentView == null) {\n            mSourceParentView = (ViewGroup) mSourceView.getParent();\n            if (mSourceParentView == null) {\n                Log.e(TAG, "the source view have not attach to any view");\n                return false;\n            }\n            int count = mSourceParentView.getChildCount();\n            for (int index = 0; index < count; index++) {\n                if (mSourceView == mSourceParentView.getChildAt(index)) {\n                    mSourceViewIndexInParent = index;\n                    break;\n                }\n            }\n        }\n        return true;\n    }\n}\n'