b'\xef\xbb\xbfusing Buttplug.Client;\nusing Buttplug.Client.Connectors.WebsocketConnector;\nusing RonSijm.ButtFish.Devices;\n\nnamespace RonSijm.ButtFish.Connectors;\n\npublic class ButtplugConnector\n{\n    private readonly ButtplugClient _client = new("ButtPlugClient");\n\n    public async Task<List<IDeviceAbstraction>> GetDiscoveredDevices(string discoverAddress = null)\n    {\n        try\n        {\n            Console.WriteLine(discoverAddress == null ? "Starting to scan for ButtPlug Devices..." : $"Attempting to connect to {discoverAddress}...");\n\n            Console.WriteLine("Will return results after 5 seconds.", Color.Green);\n\n            if (discoverAddress == null)\n            {\n                await _client.ConnectAsync(new ButtplugWebsocketConnector(new Uri("ws://localhost:12345")));\n            }\n            else\n            {\n                if (!discoverAddress.Contains("://"))\n                {\n                    discoverAddress = $"ws://{discoverAddress}";\n                }\n\n                await _client.ConnectAsync(new ButtplugWebsocketConnector(new Uri(discoverAddress)));\n            }\n\n            await _client.StartScanningAsync();\n\n            // Wait 5 seconds on ButtplugClient to find results\n            await Task.Delay(5000);\n\n            return _client.Devices.Select(locatedDevice => new ButtDevice(locatedDevice)).Cast<IDeviceAbstraction>().ToList();\n        }\n        catch (ButtplugClientConnectorException e)\n        {\n            var innerException = e.InnerException;\n            Console.WriteLine($"ButtplugConnector error: {innerException?.Message.Replace(" More detailed information in inner exception.", string.Empty)}", Color.Red);\n\n            if (innerException?.InnerException?.Message != null)\n            {\n                Console.WriteLine($"Details: {innerException?.InnerException.Message}", Color.Red);\n            }\n\n            Console.WriteLine("Try manually configuring URI for Intiface Central instead", Color.Red);\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine($"ButtplugConnector error: {e}", Color.Red);\n        }\n\n        return new List<IDeviceAbstraction>();\n    }\n}'