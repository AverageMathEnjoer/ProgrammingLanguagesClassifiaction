b'\xef\xbb\xbfusing System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Linq;\nusing System.Text;\n\nnamespace Rubeus.Kerberos.PAC {\n\n    public class SignatureData : PacInfoBuffer {\n\n        public Interop.KERB_CHECKSUM_ALGORITHM SignatureType { get; set; }\n        public byte[] Signature { get; set; }\n\n        public SignatureData(PacInfoBufferType type)\n        {\n            this.Type = type;\n        }\n        \n        public SignatureData(byte[] data, PacInfoBufferType type) : base(data, type) {\n            Decode(data);\n        }\n\n        public override byte[] Encode() {\n            BinaryWriter bw = new BinaryWriter(new MemoryStream());            \n            bw.Write((int)SignatureType);\n            bw.Write(Signature);\n            return ((MemoryStream)bw.BaseStream).ToArray();\n        }\n\n        protected override void Decode(byte[] data) {\n\n            SignatureType = (Interop.KERB_CHECKSUM_ALGORITHM)br.ReadInt32();\n\n            switch (SignatureType) {\n                case Interop.KERB_CHECKSUM_ALGORITHM.KERB_CHECKSUM_HMAC_MD5:\n                    Signature = br.ReadBytes(16);\n                    break;\n                case Interop.KERB_CHECKSUM_ALGORITHM.KERB_CHECKSUM_HMAC_SHA1_96_AES128:\n                case Interop.KERB_CHECKSUM_ALGORITHM.KERB_CHECKSUM_HMAC_SHA1_96_AES256:\n                case Interop.KERB_CHECKSUM_ALGORITHM.KERB_CHECKSUM_NONE:\n                    Signature = br.ReadBytes(12);\n                    break;\n            }\n        }\n    }\n}\n'