b'package lyons.dao;\n\nimport java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.util.ArrayList;\n\nimport lyons.db.DbClose;\nimport lyons.db.DbConn;\nimport lyons.entity.Gsales;\n\n/**\n * \xca\xfd\xbe\xdd\xbf\xe2gSales\xb1\xed\xb2\xd9\xd7\xf7\n * @author lyons(zhanglei)\n */\npublic final class GsalesDao\n{\n\t\n\tConnection        conn  = null;\n\tPreparedStatement pstmt = null;\n\tResultSet \t\t  rs    = null;\n\t\n\t/**\n\t * 1.\xb5\xb1\xcc\xec\xc2\xf4\xb3\xf6\xb5\xc4\xc9\xcc\xc6\xb7\n\t * @return ArrayList<Gsales> \xc9\xcc\xc6\xb7\xd0\xc5\xcf\xa2,\xb0\xfc\xc0\xa8 allSum (\xb5\xa5\xd6\xd6\xc9\xcc\xc6\xb7\xb5\xc4\xcf\xfa\xca\xdb\xd7\xdc\xba\xcd)\n\t */\n\tpublic ArrayList<Gsales> dailyGsales()\n\t{\n\t\tArrayList<Gsales> GsalesList = new ArrayList<Gsales>(); \n\t\tconn = DbConn.getconn();\n\n\t\t//\xca\xdb\xc2\xf4\xca\xb1\xbc\xe4=\xb5\xb1\xc7\xb0\xca\xb1\xbc\xe4 trunc(sdate) =trunc(sysdate) \xb5\xa5\xce\xbb\xa3\xba\xcc\xec\n\t\t//sql\xd3\xef\xbe\xe4\xbd\xe2\xca\xcd\xbc\xfbfiles/sql/java_sql.sql\n\t\tString sql = "select gname,gprice,gnum, allSum from goods, (select gid as salesid,sum(snum) as allSum from gsales where trunc(sdate) =trunc(sysdate) group by gid) where gid = salesid"; \n\t\ttry\n\t\t{\n\t\t\tpstmt = conn.prepareStatement(sql);\n\t\t\trs \t  = pstmt.executeQuery();\n\t\t\twhile (rs.next())\n\t\t\t{\n\t\t\t\tString gName = rs.getString(1);\n\t\t\t\tdouble gPrice = rs.getDouble(2);\n\t\t\t\tint gNum = rs.getInt(3);\n\t\t\t\tint allSnum = rs.getInt("allSum");\n\t\t\t\t\n\t\t\t\tGsales Gsales = new Gsales(gName,gPrice,gNum,allSnum);\n\t\t\t\tGsalesList.add(Gsales);\t\t\t\t\t\t\n\t\t\t}\n\t\t} catch (SQLException e)\n\t\t{\n\t\t\te.printStackTrace();\n\t\t}finally\n\t\t\t\t{\n\t\t\t\t\tDbClose.queryClose(pstmt,rs,conn);\n\t\t\t\t}\n\t\treturn GsalesList;\n\t}\n\t\n\t/**\n\t *2.\xb9\xba\xce\xef\xbd\xe1\xcb\xe3-\xcf\xf2sales\xb1\xed\xd6\xd0\xb2\xe5\xc8\xeb\xc9\xcc\xc6\xb7\xca\xfd\xbe\xdd\xa3\xa1\n\t *@param gSales \xca\xdb\xc2\xf4\xc9\xcc\xc6\xb7\xb6\xd4\xcf\xf3\n\t *@return boolean\n\t */\n\tpublic boolean shoppingSettlement(Gsales gSales)\n\t{\n\t\tboolean bool = false;\n\t\tconn = DbConn.getconn();\n\t\tString sql = "INSERT INTO GSALES(GID,SID,SNUM) VALUES(?,?,?)";\n\t\t\n\t\ttry\n\t\t{\n\t\t\tpstmt = conn.prepareStatement(sql);\n\t\t\tpstmt.setInt(1,gSales.getGId());\n\t\t\tpstmt.setInt(2,gSales.getSId());\n\t\t\tpstmt.setInt(3,gSales.getSNum());\n\t\t\t\n\t\t\tint rs = pstmt.executeUpdate();\n\t\t\tif (rs > 0)\n\t\t\t{\n\t\t\t\tbool = true;\n\t\t\t}\n\t\t} catch (SQLException e)\n\t\t{\n\t\t\te.printStackTrace();\n\t\t}finally\n\t\t{\n\t\t\tDbClose.addClose(pstmt,conn);\n\t\t}\n\t\treturn bool;\n\t}\n\t\n}\n'