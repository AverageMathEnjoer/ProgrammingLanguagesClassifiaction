b'\xef\xbb\xbfusing BaiduPanDownload.Data;\nusing BaiduPanDownload.HttpTool;\nusing BaiduPanDownload.HttpTool.Download;\nusing BaiduPanDownload.Managers;\nusing BaiduPanDownload.Util;\nusing BaiduPanDownload.Util.FileTool;\nusing Newtonsoft.Json;\nusing Newtonsoft.Json.Linq;\nusing System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.IO;\nusing System.Linq;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace BaiduPanDownload.Forms\n{\n    public partial class Main : Form\n    {\n\n        string Path = string.Empty;\n        readonly string HomePath = "/apps/Gotoway";\n\n        ArrayList DownloadList = new ArrayList();\n\n        Dictionary<string, DiskFileInfo> Fileinfo = new Dictionary<string, DiskFileInfo>();\n\n        public Main()\n        {\n            InitializeComponent();\n            Control.CheckForIllegalCrossThreadCalls = false;\n        }\n\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            new Login().ShowDialog();\n        }\n\n        private void button2_Click(object sender, EventArgs e)\n        {\n            if (Program.config.Access_Token == "null" || Program.config.Access_Token == string.Empty)\n            {\n                MessageBox.Show("\xe4\xbd\xa0\xe8\xbf\x98\xe6\x9c\xaa\xe7\x99\xbb\xe5\xbd\x95\xe5\x91\xa2");\n                return;\n            }\n            try\n            {\n                SpaceInfo info = JsonConvert.DeserializeObject<SpaceInfo>(WebTool.GetHtml("https://pcs.baidu.com/rest/2.0/pcs/quota?method=info&access_token=" + Program.config.Access_Token));\n                //Used_Lab.Text = string.Format("\xe7\xbd\x91\xe7\x9b\x98\xe5\xb7\xb2\xe4\xbd\xbf\xe7\x94\xa8: {0} / {1} (GB)", (float)info.used / 1024 / 1024 / 1024, (float)info.quota / 1024 / 1024 / 1024);\n                Text = string.Format("\xe5\xb7\xb2\xe7\x99\xbb\xe5\xbd\x95\xe8\xb4\xa6\xe6\x88\xb7 [{0}]\xef\xbc\x8c\xe5\xb7\xb2\xe4\xbd\xbf\xe7\x94\xa8\xe5\xae\xb9\xe9\x87\x8f {1} / {2} (GB)",DiskAPI.GetName(Program.config.Access_Token), (float)info.used / 1024 / 1024 / 1024, (float)info.quota / 1024 / 1024 / 1024);\n                \n            }\n            catch (Exception ex)\n            {\n                LogTool.WriteLogError(typeof(Main), "\xe6\x9b\xb4\xe6\x96\xb0\xe5\xae\xb9\xe9\x87\x8f\xe4\xbf\xa1\xe6\x81\xaf\xe6\x97\xb6\xe5\x87\xba\xe7\x8e\xb0\xe9\x94\x99\xe8\xaf\xaf",ex);\n                MessageBox.Show("\xe6\x9b\xb4\xe6\x96\xb0\xe5\xae\xb9\xe9\x87\x8f\xe4\xbf\xa1\xe6\x81\xaf\xe6\x97\xb6\xe5\x87\xba\xe7\x8e\xb0\xe9\x94\x99\xe8\xaf\xaf,\xe8\xaf\xb7\xe5\xb0\x9d\xe8\xaf\x95\xe9\x87\x8d\xe6\x96\xb0\xe7\x99\xbb\xe5\xbd\x95");\n                return;\n            }\n            new Thread(updateFileList).Start(HomePath+Path);\n        }\n\n        void updateFileList(object path)\n        {\n            try\n            {\n                Info_Lab.Text = "\xe5\x88\xb7\xe6\x96\xb0\xe4\xb8\xad..";\n                Path_ComboBox.Text = path.ToString().Replace("apps", "\xe6\x88\x91\xe7\x9a\x84\xe5\xba\x94\xe7\x94\xa8\xe6\x95\xb0\xe6\x8d\xae");\n                var jobj = JObject.Parse(WebTool.GetHtml($"https://pcs.baidu.com/rest/2.0/pcs/file?method=list&access_token={Program.config.Access_Token}&path="+ Uri.EscapeDataString($"{path.ToString()}")));\n                FilelistView.BeginUpdate();\n                FilelistView.Items.Clear();\n                Fileinfo.Clear();\n                foreach (JObject job in jobj["list"])\n                {\n                    DiskFileInfo fileinfo = JsonConvert.DeserializeObject<DiskFileInfo>(job.ToString());\n                    FilelistView.Items.Add(fileinfo.getName());\n                    this.Fileinfo.Add(fileinfo.getName(), fileinfo);\n                    if (fileinfo.isdir == 1)\n                    {\n                        setEndItemImageKey("Dir.png");\n                    }\n                    else\n                    {\n                        setEndItemImageKey(getIconImage(fileinfo.getSuffix()));\n                    }\n\n                }\n                FilelistView.EndUpdate();\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show("\xe6\x9b\xb4\xe6\x96\xb0\xe6\x96\x87\xe4\xbb\xb6\xe5\x88\x97\xe8\xa1\xa8\xe6\x97\xb6\xe9\x81\x87\xe5\x88\xb0\xe6\x84\x8f\xe5\xa4\x96\xe7\x9a\x84\xe9\x94\x99\xe8\xaf\xaf: "+ex.ToString());\n            }\n            Info_Lab.Text = "\xe7\xad\x89\xe5\xbe\x85\xe4\xb8\xad";\n        }\n\n        void setEndItemImageKey(string key)\n        {\n            FilelistView.Items[FilelistView.Items.Count - 1].ImageKey = key;\n        }\n\n        string getIconImage(string suffix)\n        {\n            switch (suffix)\n            {\n                case "zip":\n                    return "zip.png";\n                case "rar":\n                    return "zip.png";\n                case "exe":\n                    return "exe.png";\n                default:\n                    return "File.png";\n            }\n        }\n\n        private void FilelistView_MouseDoubleClick(object sender, MouseEventArgs e)\n        {\n            if (FilelistView.SelectedIndices.Count <= 0)\n            {\n                return;\n            }\n            if (Fileinfo.ContainsKey(FilelistView.SelectedItems[0].Text))\n            {\n                DiskFileInfo info = Fileinfo[FilelistView.SelectedItems[0].Text];\n                if (info.isdir == 1)\n                {\n                    Path += "/" + FilelistView.SelectedItems[0].Text;\n                    new Thread(this.updateFileList).Start(HomePath + Path);\n                    return;\n                }\n                new Download()\n                {\n                    Info = info\n                }.ShowDialog();\n            }\n        }\n\n        private void Back_Button_Click(object sender, EventArgs e)\n        {\n            if (Path == string.Empty)\n            {\n                MessageBox.Show("\xe5\xb7\xb2\xe7\xbb\x8f\xe6\xb2\xa1\xe6\x9c\x89\xe7\x9b\xae\xe5\xbd\x95\xe5\x8f\xaf\xe4\xbb\xa5\xe8\xbf\x94\xe5\x9b\x9e\xe4\xba\x86\xe5\x93\xa6");\n                return;\n            }\n            string[] tmp = Path.Split(\'/\');\n            Path = Path.Replace("/"+tmp[tmp.Length-1],string.Empty);\n            new Thread(updateFileList).Start(HomePath + Path);\n        }\n\n        private void \xe6\x96\x87\xe4\xbb\xb6\xe4\xbf\xa1\xe6\x81\xafToolStripMenuItem_Click_1(object sender, EventArgs e)\n        {\n            if (FilelistView.SelectedIndices.Count <= 0)\n            {\n                MessageBox.Show("\xe4\xbd\xa0\xe6\xb2\xa1\xe6\x9c\x89\xe9\x80\x89\xe4\xb8\xad\xe4\xbb\xbb\xe4\xbd\x95\xe6\x96\x87\xe4\xbb\xb6\xe5\x93\xa6");\n                return;\n            }\n            if (!Fileinfo.ContainsKey(FilelistView.SelectedItems[0].Text))\n            {\n                MessageBox.Show("\xe5\x87\xba\xe7\x8e\xb0\xe4\xba\x86\xe6\x9c\xaa\xe7\x9f\xa5\xe9\x94\x99\xe8\xaf\xaf! \xe8\xaf\xb7\xe5\x88\xb7\xe6\x96\xb0\xe9\x87\x8d\xe8\xaf\x95");\n                return;\n            }\n            DiskFileInfo info = Fileinfo[FilelistView.SelectedItems[0].Text];\n            MessageBox.Show(\n                "\xe6\x96\x87\xe4\xbb\xb6\xe5\x90\x8d: " + info.getName() + Environment.NewLine +\n                "\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xa7\xe5\xb0\x8f: " + (getSizeGB(info.size) < 1 ? getSizeMB(info.size) + " MB" : getSizeGB(info.size) + " GB") + Environment.NewLine +\n                "MD5:"+info.md5+Environment.NewLine+\n                "\xe6\x96\x87\xe4\xbb\xb6\xe8\xb7\xaf\xe5\xbe\x84: " + info.path.Replace("apps", "\xe6\x88\x91\xe7\x9a\x84\xe5\xba\x94\xe7\x94\xa8\xe6\x95\xb0\xe6\x8d\xae")+Environment.NewLine+\n                "\xe6\x98\xaf\xe4\xb8\x8d\xe6\x98\xaf\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9: "+(info.isdir==1?"\xe6\x98\xaf":"\xe4\xb8\x8d\xe6\x98\xaf")\n                ,"\xe6\x96\x87\xe4\xbb\xb6\xe4\xbf\xa1\xe6\x81\xaf"\n                );\n        }\n\n        float getSizeGB(long byt)\n        {\n            return (float)byt / 1024 / 1024 / 1024;\n        }\n\n        float getSizeMB(long byt)\n        {\n            return (float)byt / 1024 / 1024;\n        }\n\n        private void Help_Link_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)\n        {\n            /*\n            MessageBox.Show(\n                "\xe5\x90\xa7\xe8\xa6\x81\xe4\xb8\x8b\xe8\xbd\xbd\xe7\x9a\x84\xe6\x96\x87\xe4\xbb\xb6\xe6\x94\xbe\xe5\x88\xb0\xe6\x82\xa8\xe7\x99\xbe\xe5\xba\xa6\xe7\xbd\x91\xe7\x9b\x98\xe7\x9a\x84 [/\xe6\x88\x91\xe7\x9a\x84\xe5\xba\x94\xe7\x94\xa8\xe6\x95\xb0\xe6\x8d\xae/wp2pcs/] \xe7\x9b\xae\xe5\xbd\x95,\xe5\x8d\xb3\xe5\x8f\xaf\xe5\x9c\xa8\xe6\x9c\xac\xe7\xa8\x8b\xe5\xba\x8f\xe8\xae\xbf\xe9\x97\xae"+Environment.NewLine+\n                "\xe5\x8f\x8c\xe5\x87\xbb\xe6\x96\x87\xe4\xbb\xb6\xe4\xb8\xba\xe4\xb8\x8b\xe8\xbd\xbd;\xe5\x8f\x8c\xe5\x87\xbb\xe7\x9b\xae\xe5\xbd\x95\xe4\xb8\xba\xe6\x89\x93\xe5\xbc\x80\xe7\x9b\xae\xe5\xbd\x95" +Environment.NewLine+\n                "\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9\xe4\xb8\x8b\xe8\xbd\xbd\xe8\xaf\xb7\xe4\xbd\xbf\xe7\x94\xa8\xe5\x8f\xb3\xe9\x94\xae\xe4\xb8\x8b\xe8\xbd\xbd"+Environment.NewLine+\n                "\xe5\xa6\x82\xe6\x9e\x9c\xe5\x88\xb7\xe6\x96\xb0\xe5\x87\xba\xe7\x8e\xb0\xe9\x94\x99\xe8\xaf\xaf,\xe8\xaf\xb7\xe9\x87\x8d\xe6\x96\xb0\xe7\x99\xbb\xe5\xbd\x95!"+Environment.NewLine+\n                "\xe6\x96\xb0\xe5\xa2\x9e\xe5\x8a\xa0\xe4\xb8\x8a\xe4\xbc\xa0\xe6\x96\x87\xe4\xbb\xb6!\xe7\x9b\xb4\xe6\x8e\xa5\xe6\x8a\x8a\xe6\x96\x87\xe4\xbb\xb6\xe6\x8b\x96\xe5\x85\xa5\xe5\x8d\xb3\xe5\x8f\xaf,\xe4\xb8\x8d\xe6\x94\xaf\xe6\x8c\x81\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9!!!"\n                ,"\xe5\xb8\xae\xe5\x8a\xa9"\n                );\n                */\n            try\n            {\n                System.Diagnostics.Process.Start("http://www.mrs4s.top/2016/10/06/%E3%80%90c%E5%B0%8F%E5%B7%A5%E5%85%B7%E3%80%91%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E4%B8%8D%E9%99%90%E9%80%9F%E4%B8%8B%E8%BD%BD%E5%B7%A5%E5%85%B7");\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show("\xe8\xb0\x83\xe7\x94\xa8\xe6\xb5\x8f\xe8\xa7\x88\xe5\x99\xa8\xe5\xa4\xb1\xe8\xb4\xa5! " + ex.Message);\n            }\n        }\n\n        private void Blog_Link_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)\n        {\n            try\n            {\n                System.Diagnostics.Process.Start("http://www.mrs4s.top");\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show("\xe8\xb0\x83\xe7\x94\xa8\xe6\xb5\x8f\xe8\xa7\x88\xe5\x99\xa8\xe5\xa4\xb1\xe8\xb4\xa5! " + ex.Message);\n            }\n        }\n\n        private void Main_Load(object sender, EventArgs e)\n        {\n            System.Net.ServicePointManager.DefaultConnectionLimit = 999999;\n            if (!Directory.Exists(Program.config.TempPath))\n            {\n                Directory.CreateDirectory(Program.config.TempPath);\n            }\n            LoadConfig();\n            if (Program.config.WebDownload)\n            {\n                new WebDownload().Listen();\n            }\n            new Thread(Upgraded).Start();\n            if (Program.config.Access_Token == "null" || Program.config.Access_Token == string.Empty)\n            {\n                return;\n            }\n            try\n            {\n                SpaceInfo info = JsonConvert.DeserializeObject<SpaceInfo>(WebTool.GetHtml("https://pcs.baidu.com/rest/2.0/pcs/quota?method=info&access_token=" + Program.config.Access_Token));\n               // Used_Lab.Text = string.Format("\xe7\xbd\x91\xe7\x9b\x98\xe5\xb7\xb2\xe4\xbd\xbf\xe7\x94\xa8: {0} / {1} (GB)", (float)info.used / 1024 / 1024 / 1024, (float)info.quota / 1024 / 1024 / 1024);\n                Text = string.Format("\xe5\xb7\xb2\xe7\x99\xbb\xe5\xbd\x95\xe8\xb4\xa6\xe6\x88\xb7 [{0}]\xef\xbc\x8c\xe5\xb7\xb2\xe4\xbd\xbf\xe7\x94\xa8\xe5\xae\xb9\xe9\x87\x8f {1} / {2} (GB)", DiskAPI.GetName(Program.config.Access_Token), (float)info.used / 1024 / 1024 / 1024, (float)info.quota / 1024 / 1024 / 1024);\n            }\n            catch (Exception ex)\n            {\n                LogTool.WriteLogError(typeof(Main), "\xe6\x9b\xb4\xe6\x96\xb0\xe5\xae\xb9\xe9\x87\x8f\xe4\xbf\xa1\xe6\x81\xaf\xe6\x97\xb6\xe5\x87\xba\xe7\x8e\xb0\xe9\x94\x99\xe8\xaf\xaf", ex);\n                MessageBox.Show("\xe6\x9b\xb4\xe6\x96\xb0\xe5\xae\xb9\xe9\x87\x8f\xe4\xbf\xa1\xe6\x81\xaf\xe6\x97\xb6\xe5\x87\xba\xe7\x8e\xb0\xe9\x94\x99\xe8\xaf\xaf,\xe8\xaf\xb7\xe5\xb0\x9d\xe8\xaf\x95\xe9\x87\x8d\xe6\x96\xb0\xe7\x99\xbb\xe5\xbd\x95");\n                return;\n            }\n            DownloadListView.View = View.Details;\n            new Thread(updateFileList).Start(HomePath + Path);\n            \n        }\n        void LoadConfig()\n        {\n            if (Program.config.NetSpeed > 120)\n            {\n                Program.config.NetSpeed = 30;\n                Program.config.save();\n                MessageBox.Show("\xe6\x9a\x82\xe6\x97\xb6\xe4\xb8\x8d\xe5\x85\xbc\xe5\xae\xb9\xe8\xbf\x99\xe4\xb9\x88\xe5\xbf\xab\xe7\x9a\x84\xe7\xbd\x91\xe9\x80\x9f");\n            }\n            TaskManager.GetTastManager.ReloadTask();\n        }\n        /// <summary>\n        /// \xe6\xa3\x80\xe6\x9f\xa5\xe6\x9b\xb4\xe6\x96\xb0\n        /// </summary>\n        void Upgraded()\n        {\n            try\n            {\n                JObject job = JObject.Parse(WebTool.GetHtml("http://www.mrs4s.top/api/update.json"));\n                //\xe7\x89\x88\xe6\x9c\xac13\n                if ((int)job["Build"] > 13)\n                {\n                    DialogResult dr = MessageBox.Show((string)job["Message"] + "\\r\\n\\r\\n\xe6\x98\xaf\xe5\x90\xa6\xe6\x9b\xb4\xe6\x96\xb0?", "\xe5\x8f\x91\xe7\x8e\xb0\xe6\x9b\xb4\xe6\x96\xb0", MessageBoxButtons.OKCancel);\n                    if (dr == DialogResult.OK)\n                    {\n                        try\n                        {\n                            System.Diagnostics.Process.Start((string)job["Yes_Button"]);\n                        }\n                        catch (Exception ex)\n                        {\n                            MessageBox.Show("\xe8\xb0\x83\xe7\x94\xa8\xe6\xb5\x8f\xe8\xa7\x88\xe5\x99\xa8\xe5\xa4\xb1\xe8\xb4\xa5! " + ex.Message);\n                        }\n                    }\n                }\n            }\n            catch { }\n        }\n\n        public void AddDownloadFile(DiskFileInfo info,string DownloadPath,string FileName)\n        {\n            //TaskManager.GetTastManager.CreateDownloadTask($"https://www.baidupcs.com/rest/2.0/pcs/stream?method=download&access_token={Program.config.Access_Token}&path=" + Uri.EscapeDataString(info.path),DownloadPath+"\\\\"+FileName);\n            TaskManager.GetTastManager.CreateDownloadTask($"https://pcs.baidu.com/rest/2.0/pcs/file?method=download&access_token={Program.config.Access_Token}&path=" + Uri.EscapeDataString(info.path), DownloadPath + "\\\\" + FileName);\n        }\n\n        int getDownloadTaskNum()\n        {\n            var ret = 0;\n            for(int i = 0; i < DownloadListView.Items.Count; i++)\n            {\n                if (DownloadListView.Items[i].SubItems[4].Text == "\xe4\xb8\x8b\xe8\xbd\xbd\xe4\xb8\xad" || DownloadListView.Items[i].SubItems[4].Text=="\xe6\x9a\x82\xe5\x81\x9c\xe4\xb8\xad")\n                {\n                    ret++;\n                }\n            }\n            return ret;\n        }\n\n\n        private void \xe6\x96\xb0\xe5\xbb\xba\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9ToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            new NewDir(HomePath + Path).ShowDialog();\n            new Thread(updateFileList).Start(HomePath + Path);\n        }\n\n        private void \xe5\x88\xa0\xe9\x99\xa4ToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            for (int i = 0; i < FilelistView.SelectedIndices.Count; i++)\n            {\n                if (!Fileinfo.ContainsKey(FilelistView.SelectedItems[i].Text))\n                {\n                    MessageBox.Show("\xe5\x87\xba\xe7\x8e\xb0\xe4\xba\x86\xe6\x9c\xaa\xe7\x9f\xa5\xe9\x94\x99\xe8\xaf\xaf! \xe8\xaf\xb7\xe5\x88\xb7\xe6\x96\xb0\xe9\x87\x8d\xe8\xaf\x95");\n                    return;\n                }\n                DiskFileInfo info = Fileinfo[FilelistView.SelectedItems[i].Text];\n                if (WebTool.GetHtml(string.Format("https://pcs.baidu.com/rest/2.0/pcs/file?method=delete&access_token={0}&path={1}", Program.config.Access_Token, info.path)).Contains("ERROR"))\n                {\n                    MessageBox.Show("\xe5\x88\xa0\xe9\x99\xa4\xe5\xa4\xb1\xe8\xb4\xa5");\n                    return;\n                }\n            }\n            new Thread(updateFileList).Start(HomePath + Path);\n        }\n        private void button3_Click(object sender, EventArgs e)\n        {\n        }\n\n        private void \xe6\xb7\xbb\xe5\x8a\xa0\xe5\x88\xb0\xe4\xb8\x8b\xe8\xbd\xbd\xe5\x88\x97\xe8\xa1\xa8ToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            for (int i = 0; i < FilelistView.SelectedIndices.Count; i++)\n            {\n                if (!Fileinfo.ContainsKey(FilelistView.SelectedItems[i].Text))\n                {\n                    MessageBox.Show("\xe5\x87\xba\xe7\x8e\xb0\xe4\xba\x86\xe6\x9c\xaa\xe7\x9f\xa5\xe9\x94\x99\xe8\xaf\xaf! \xe8\xaf\xb7\xe5\x88\xb7\xe6\x96\xb0\xe9\x87\x8d\xe8\xaf\x95");\n                    return;\n                }\n                DiskFileInfo info = Fileinfo[FilelistView.SelectedItems[i].Text];\n                new Download()\n                {\n                    Info = info\n                }.ShowDialog();\n            }\n            //string url = string.Format("https://www.baidupcs.com/rest/2.0/pcs/stream?method=download&access_token={0}&path={1}", Program.config.Access_Token, info.path);\n        }\n\n        private void \xe5\xa4\x8d\xe5\x88\xb6\xe4\xb8\x8b\xe8\xbd\xbd\xe5\x9c\xb0\xe5\x9d\x80ToolStripMenuItem1_Click(object sender, EventArgs e)\n        {\n            if (!Fileinfo.ContainsKey(FilelistView.SelectedItems[0].Text))\n            {\n                MessageBox.Show("\xe5\x87\xba\xe7\x8e\xb0\xe4\xba\x86\xe6\x9c\xaa\xe7\x9f\xa5\xe9\x94\x99\xe8\xaf\xaf! \xe8\xaf\xb7\xe5\x88\xb7\xe6\x96\xb0\xe9\x87\x8d\xe8\xaf\x95");\n                return;\n            }\n            CopyFilesAddress();\n        }\n\n        private void CopyFilesAddress()\n        {\n            StringBuilder sb = new StringBuilder();\n            foreach (ListViewItem item in FilelistView.SelectedItems)\n            {\n                var info = Fileinfo[item.Text];\n                if (info.isdir == 1)\n                {\n                    Console.WriteLine("\xe6\x9a\x82\xe6\x97\xb6\xe4\xb8\x8d\xe6\x94\xaf\xe6\x8c\x81\xe5\xa4\x8d\xe5\x88\xb6\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9...");\n                }\n                else\n                {\n                    sb.AppendLine($"https://www.baidupcs.com/rest/2.0/pcs/stream?method=download&access_token={Program.config.Access_Token}&path="+ Uri.EscapeDataString($"{info.path}"));\n                }\n            }\n            try\n            {\n\n                Clipboard.SetDataObject(sb.ToString());\n                Console.WriteLine(sb.ToString());\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show("\xe8\xae\xbf\xe9\x97\xae\xe5\x89\xaa\xe8\xb4\xb4\xe6\x9d\xbf\xe5\xa4\xb1\xe8\xb4\xa5! " + ex.Message);\n            }\n        }\n\n        private void UpdateDownLoadList_Timer_Tick(object sender, EventArgs e)\n        {\n            DownloadListView.BeginUpdate();\n            foreach (HttpDownload Task in TaskManager.GetTastManager.GetTaskList())\n            {\n                if (DownloadListView.Items.Count == Task.ID)\n                {\n                    ListViewItem item = new ListViewItem();\n                    item.Text = Task.ID.ToString();\n                    item.SubItems.Add(Task.DownloadPath.Split(\'\\\\\')[Task.DownloadPath.Split(\'\\\\\').Length-1]);\n                    item.SubItems.Add(Task.DownloadPath);\n                    item.SubItems.Add((getSizeMB((long)Task.Speed) < 1 ? (Task.Speed / 1024) + "K/s" : getSizeMB((long)Task.Speed) + "M/s"));\n                    item.SubItems.Add(Task.Percentage + "%");\n                    item.SubItems.Add(Task.Downloading?"\xe4\xb8\x8b\xe8\xbd\xbd\xe4\xb8\xad":Task.Completed?"\xe4\xb8\x8b\xe8\xbd\xbd\xe5\xae\x8c\xe6\x88\x90":"\xe6\x9a\x82\xe5\x81\x9c\xe4\xb8\xad");\n                    DownloadListView.Items.Add(item);\n                    continue;\n                }\n                DownloadListView.Items[Task.ID].SubItems[3].Text = Task.Completed ? "0K/S" : (getSizeMB((long)Task.Speed) < 1 ? (Task.Speed / 1024) + "K/s" : getSizeMB((long)Task.Speed) + "M/s");\n                DownloadListView.Items[Task.ID].SubItems[4].Text = Task.Completed?"100%":Task.Percentage + "%";\n                DownloadListView.Items[Task.ID].SubItems[5].Text = Task.Downloading ? "\xe4\xb8\x8b\xe8\xbd\xbd\xe4\xb8\xad" : Task.Completed ? "\xe4\xb8\x8b\xe8\xbd\xbd\xe5\xae\x8c\xe6\x88\x90" : "\xe6\x9a\x82\xe5\x81\x9c\xe4\xb8\xad";\n            }\n            DownloadListView.EndUpdate();\n            return;\n            \n        }\n\n        private void \xe6\x9a\x82\xe5\x81\x9cToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            TaskManager.GetTastManager.GetTaskByID(int.Parse(DownloadListView.SelectedItems[0].Text)).StopAndSave();\n        }\n\n\n        void OpenFolderAndSelectFile(string fileFullName)\n        {\n            System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo("Explorer.exe");\n            psi.Arguments = "/e,/select," + fileFullName;\n            System.Diagnostics.Process.Start(psi);\n        }\n\n        private void \xe6\x89\x93\xe5\xbc\x80\xe7\x9b\xae\xe5\xbd\x95ToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n\n            var FilePath = TaskManager.GetTastManager.GetTaskByID(int.Parse(DownloadListView.SelectedItems[0].Text)).DownloadPath;\n            if (!File.Exists(FilePath))\n            {\n                MessageBox.Show("\xe6\x96\x87\xe4\xbb\xb6\xe4\xb8\x8d\xe5\xad\x98\xe5\x9c\xa8,\xe4\xbc\xbc\xe4\xb9\x8e\xe5\xb7\xb2\xe7\xbb\x8f\xe8\xa2\xab\xe5\x88\xa0\xe9\x99\xa4\xe4\xba\x86");\n                return;\n            }\n            OpenFolderAndSelectFile(FilePath);\n            \n        }\n\n        private void \xe7\xbb\x88\xe6\xad\xa2ToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            //TaskManager.GetTastManager.GetTaskByID(int.Parse(DownloadListView.SelectedItems[0].Text)).StopTask();\n        }\n\n        private void Main_FormClosing(object sender, FormClosingEventArgs e)\n        {\n            this.UpdateDownLoadList_Timer.Stop();\n            this.UpdateDownLoadList_Timer.Dispose();\n            TaskManager.GetTastManager.StopAndSave();\n            //Environment.Exit(0);\n        }\n        private void Test_Button_Click(object sender, EventArgs e)\n        {\n            \n        }\n\n        private void FilelistView_DragEnter(object sender, DragEventArgs e)\n        {\n            if (e.Data.GetDataPresent(DataFormats.FileDrop))\n            {\n                e.Effect = DragDropEffects.Link;\n                return;\n            }\n            e.Effect = DragDropEffects.None;\n        }\n\n        private void FilelistView_DragDrop(object sender, DragEventArgs e)\n        {\n            MessageBox.Show("\xe5\xbd\x93\xe5\x89\x8d\xe7\x89\x88\xe6\x9c\xac\xe6\x9a\x82\xe6\x97\xb6\xe4\xb8\x8d\xe6\x94\xaf\xe6\x8c\x81\xe4\xb8\x8a\xe4\xbc\xa0");\n        }\n\n        private void \xe7\xb2\x98\xe8\xb4\xb4ToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            //MessageBox.Show("\xe8\xbf\x98\xe6\xb2\xa1\xe5\x86\x99\xe5\xae\x8c\xe3\x80\x82\xe3\x80\x82");\n            CopyManager.GetCopyManager.Copy(HomePath+Path);\n            new Thread(updateFileList).Start(HomePath+Path);\n        }\n\n        private void \xe5\xa4\x8d\xe5\x88\xb6ToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            //MessageBox.Show("\xe8\xbf\x98\xe6\xb2\xa1\xe5\x86\x99\xe5\xae\x8c\xe3\x80\x82\xe3\x80\x82");\n            if (!Fileinfo.ContainsKey(FilelistView.SelectedItems[0].Text))\n            {\n                MessageBox.Show("\xe5\x87\xba\xe7\x8e\xb0\xe4\xba\x86\xe6\x9c\xaa\xe7\x9f\xa5\xe9\x94\x99\xe8\xaf\xaf! \xe8\xaf\xb7\xe5\x88\xb7\xe6\x96\xb0\xe9\x87\x8d\xe8\xaf\x95");\n                return;\n            }\n            for(int i = 0; i < FilelistView.SelectedItems.Count; i++)\n            {\n                var info = Fileinfo[FilelistView.SelectedItems[i].Text];\n                CopyManager.GetCopyManager.AddFile(info);\n            }\n\n        }\n\n        private void InfoMenu_Opening(object sender, CancelEventArgs e)\n        {\n            if (FilelistView.SelectedIndices.Count <= 0)\n            {\n                e.Cancel = true;\n                return;\n            }\n        }\n\n        private void DownLoadListMenu_Opening(object sender, CancelEventArgs e)\n        {\n            if (DownloadListView.SelectedIndices.Count <= 0)\n            {\n                e.Cancel = true;\n                return;\n            }\n        }\n\n        private void \xe5\x88\x86\xe4\xba\xab\xe6\x96\x87\xe4\xbb\xb6ToolStripMenuItem1_Click(object sender, EventArgs e)\n        {\n\n        }\n\n        private void FilelistView_KeyDown(object sender, KeyEventArgs e)\n        {\n            //Ctrl+C\n            if(e.Control && e.KeyValue == 67)\n            {\n                if (FilelistView.SelectedIndices.Count <= 0)\n                {\n                    return;\n                }\n                if (!Fileinfo.ContainsKey(FilelistView.SelectedItems[0].Text))\n                {\n                    MessageBox.Show("\xe5\x87\xba\xe7\x8e\xb0\xe4\xba\x86\xe6\x9c\xaa\xe7\x9f\xa5\xe9\x94\x99\xe8\xaf\xaf! \xe8\xaf\xb7\xe5\x88\xb7\xe6\x96\xb0\xe9\x87\x8d\xe8\xaf\x95");\n                    return;\n                }\n                CopyManager.GetCopyManager.Clear();\n                for (int i = 0; i < FilelistView.SelectedItems.Count; i++)\n                {\n                    var info = Fileinfo[FilelistView.SelectedItems[i].Text];\n                    CopyManager.GetCopyManager.AddFile(info);\n                }\n                return;\n            }\n            //Ctrl+V\n            if(e.Control && e.KeyValue == 86)\n            {\n                CopyManager.GetCopyManager.Copy(HomePath + Path);\n                new Thread(updateFileList).Start(HomePath + Path);\n                return;\n            }\n        }\n\n        private void DownloadListView_MouseDoubleClick(object sender, MouseEventArgs e)\n        {\n            if (DownloadListView.SelectedItems.Count < 1)\n            {\n                return;\n            }\n            var Task=TaskManager.GetTastManager.GetTaskByID(int.Parse(DownloadListView.SelectedItems[0].Text));\n        }\n\n\n        private void NetSpeed_TextBox_KeyPress(object sender, KeyPressEventArgs e)\n        {\n            if(!(Char.IsNumber(e.KeyChar)) && e.KeyChar != 8)\n            {\n                e.Handled = true;\n            }\n        }\n\n        private void SuperDLSize_Textbox_KeyPress(object sender, KeyPressEventArgs e)\n        {\n            if (!(Char.IsNumber(e.KeyChar)) && e.KeyChar != 8)\n            {\n                e.Handled = true;\n            }\n        }\n\n        private void \xe7\xbb\x88\xe6\xad\xa2ToolStripMenuItem_Click_1(object sender, EventArgs e)\n        {\n            MessageBox.Show("\xe5\xbd\x93\xe5\x89\x8d\xe7\x89\x88\xe6\x9c\xac\xe6\x97\xa0\xe5\x81\x9c\xe6\xad\xa2\xe5\x8a\x9f\xe8\x83\xbd,\xe8\xaf\xb7\xe7\xad\x89\xe5\xbe\x85\xe4\xb8\x8b\xe4\xb8\xaa\xe7\x89\x88\xe6\x9c\xac");\n        }\n\n        private void \xe7\xbb\xa7\xe7\xbb\xadToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            TaskManager.GetTastManager.GetTaskByID(int.Parse(DownloadListView.SelectedItems[0].Text)).Start();\n        }\n\n        private void button5_Click(object sender, EventArgs e)\n        {\n            new Setting().ShowDialog();\n        }\n\n        private void Path_ComboBox_KeyPress(object sender, KeyPressEventArgs e)\n        {\n            e.Handled = true;\n        }\n\n        private void linkLabel1_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)\n        {\n            new About().ShowDialog();\n        }\n    }\n}\n'