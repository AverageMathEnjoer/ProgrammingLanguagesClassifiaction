b'package lyons.goods.action;\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\n\n\nimport lyons.goods.entity.Goods;\nimport lyons.goods.service.GoodsServiceImpl;\nimport lyons.user.service.UserService;\nimport lyons.util.Iconst;\n\n/**\n * \n * \xb4\xa6\xc0\xedGoods\xb1\xed  \xb5\xc8\xb4\xfd\xb4\xfa\xc2\xeb\xd6\xd8\xb9\xb9\xa3\xac\xcc\xab\xc2\xd2\n * @author  lyons(zhanglei)\n * \n */\n@SuppressWarnings("serial")\npublic class GoodsAction extends HttpServlet\n{\n\n    String user;\n    String key;\n    String keyWord;\n    String goodsClassify;\n    public void doGet(HttpServletRequest request, HttpServletResponse response)\n        throws ServletException, IOException\n    {\n        this.doPost(request, response);\n    }\n    \n    public void doPost(HttpServletRequest request, HttpServletResponse response)\n        throws ServletException, IOException\n    {\n        response.setContentType("text/html;chartset=UTF-8");\n        request.setCharacterEncoding("UTF-8");\n        \n        //\xc5\xd0\xb6\xcf\xca\xc7\xb7\xf1\xb5\xc7\xc2\xbd\n        user = (new UserService()).isLogin(request, response).trim();\n        if ( "".equals(user) || user == null ){return;}\n        \n        key = request.getParameter("key");\n        keyWord = request.getParameter("keyWord");\n        goodsClassify = request.getParameter("goodsClassify");\n        \n        queryCondition(key,keyWord,goodsClassify,request,response);//key \xb4\xfa\xb1\xed\xb2\xe9\xd1\xaf\xcc\xf5\xbc\xfe\xa3\xackeyWord\xb4\xfa\xb1\xed\xd2\xaa\xb2\xe9\xd1\xaf\xb5\xc4\xb9\xd8\xbc\xfc\xd7\xd6\n    }\n\n    public void queryCondition(String key, String keyWord,String goodsClassify,HttpServletRequest request, HttpServletResponse response) \n         throws IOException, ServletException\n    {\n        response.setContentType("text/html;charset=UTF-8");\n        PrintWriter out = response.getWriter();\n        \n        HttpSession session = request.getSession(true);\n\n        List<Goods> goodsList = new ArrayList<Goods>();\n        GoodsServiceImpl goodsService = new GoodsServiceImpl();//\xbb\xf1\xc8\xa1\xc9\xcc\xc6\xb7\xb7\xfe\xce\xf1\xb6\xd4\xcf\xf3\n        Goods goods = null;\n        goods = (Goods)session.getAttribute("goods");\n        if (goods==null)\n        {\n            goods = new Goods();\n            session.setAttribute("goods", goods);\n        }\n        \n        \n        //key=1 \xb2\xe9\xd1\xaf\xc9\xcc\xc6\xb7\xd0\xc5\xcf\xa2 \xa3\xa8\xb9\xd8\xbc\xfc\xd7\xd6||\xb7\xd6\xc0\xe0\xa3\xa9or\xa3\xa8\xb9\xd8\xbc\xfc\xd7\xd6&&\xb7\xd6\xc0\xe0\xa3\xa9\n        //key=2 \xb0\xb4\xd5\xd5\xb9\xd8\xbc\xfc\xd7\xd6\xb2\xe9\xd1\xaf \xc9\xcc\xc6\xb7\xd0\xc5\xcf\xa2\n        //key=4 \xb2\xe9\xd1\xaf\xc9\xcc\xc6\xb7\xc1\xd0\xb1\xed\n        if ("1".equals(key)){\n                goodsList = goodsService.queryGoodsByKeyClassify(keyWord,goodsClassify);\n        }else if ("2".equals(key)) {\n                      goodsList = goodsService.queryGoodsByKey(keyWord);\n                 }else if ("4".equals(key)) {\n                               goodsList = goodsService.queryList();\n                         }\n        //\xb4\xa6\xc0\xed\xb2\xe9\xd1\xaf\xbd\xe1\xb9\xfb\n        if(goodsList.size()>0)\n        {\n            goods.setGoodsList(goodsList);\n            session.setAttribute("goods", goods);\n            request.getRequestDispatcher("/jsp/browse/showGoods.jsp").forward(request, response);\n        }else if("4".equals(key)){\n                    out.print(Iconst.QUERY_ALLGOODS_RETURN_NULL);\n              }else{\n                 out.print(Iconst.QUERY_ALLGOODS_BY_CONDITION_RETURN_NULL);     \n              }\n\n    }\n    \n}\n'