b'\xef\xbb\xbfusing System;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\nnamespace DMSkin.Core.Helper\n{\n    /// <summary>\n    /// INI\xe6\x96\x87\xe4\xbb\xb6\xe8\xaf\xbb\xe5\x86\x99\xe7\xb1\xbb\n    /// </summary>\n    public class INIHelper\n    {\n        #region \xe5\x88\x9d\xe5\xa7\x8b\xe5\x8c\x96\n        private static string Path;\n        /// <summary>\n        /// \xe5\x88\x9d\xe5\xa7\x8b\xe5\x8c\x96\n        /// </summary>\n        public static void Initialize(string path)\n        {\n            Path = path;\n        }\n        #endregion\n\n        #region DLL\xe7\x94\xb3\xe6\x98\x8e\n        //\xe5\xa3\xb0\xe6\x98\x8eAPI\xe5\x87\xbd\xe6\x95\xb0\n        [DllImport("kernel32")]\n        private static extern long WritePrivateProfileString(string section, string key, string val, string filePath);\n        [DllImport("kernel32")]\n        private static extern int GetPrivateProfileString(string section, string key, string def, StringBuilder retVal, int size, string filePath);\n        #endregion\n\n        #region \xe5\x86\x99\xe5\x85\xa5\n        /// <summary> \n        /// \xe5\x86\x99\xe5\x85\xa5INI\xe6\x96\x87\xe4\xbb\xb6 \n        /// </summary> \n        /// <param name="Section">\xe9\xa1\xb9\xe7\x9b\xae\xe5\x90\x8d\xe7\xa7\xb0(\xe5\xa6\x82 [TypeName] )</param> \n        /// <param name="Key">\xe9\x94\xae</param> \n        /// <param name="Value">\xe5\x80\xbc</param> \n        public static void Write(string Section, string Key, string Value)\n        {\n            WritePrivateProfileString(Section, Key, Value, Path);\n        }\n        #endregion\n\n        #region \xe8\xaf\xbb\xe5\x8f\x96\n        /// <summary> \n        /// \xe8\xaf\xbb\xe5\x87\xbaINI\xe6\x96\x87\xe4\xbb\xb6 \n        /// </summary> \n        /// <param name="Section">\xe9\xa1\xb9\xe7\x9b\xae\xe5\x90\x8d\xe7\xa7\xb0(\xe5\xa6\x82 [TypeName] )</param> \n        /// <param name="Key">\xe9\x94\xae</param> \n        public static string Read(string Section, string Key)\n        {\n            StringBuilder temp = new StringBuilder(500);\n            GetPrivateProfileString(Section, Key, "", temp, 500, Path);\n            return temp.ToString();\n        }\n        #endregion\n\n        #region \xe8\xaf\xbb\xe5\x8f\x96\xe6\xb3\x9b\xe5\x9e\x8b\n        /// <summary>\n        /// \xe8\xaf\xbb\xe5\x8f\x96\xe6\xb3\x9b\xe5\x9e\x8bINI\xe6\x95\xb0\xe6\x8d\xae\n        /// </summary>\n        public static T Read<T>(string Section, string Key)\n        {\n            StringBuilder temp = new StringBuilder(1024);\n            GetPrivateProfileString(Section, Key, "", temp, 1024, Path);\n            try\n            {\n                string tempstr = temp.ToString();\n                if (!string.IsNullOrWhiteSpace(tempstr))\n                {\n                    return (T)Convert.ChangeType(tempstr, typeof(T));\n                }\n            }\n            catch (Exception)\n            {\n            }\n            return default;\n        } \n        #endregion\n    }\n}\n'