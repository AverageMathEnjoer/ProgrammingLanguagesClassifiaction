b'package com.codeest.geeknews.presenter.zhihu;\n\nimport com.codeest.geeknews.base.RxPresenter;\nimport com.codeest.geeknews.model.DataManager;\nimport com.codeest.geeknews.model.bean.ThemeChildListBean;\nimport com.codeest.geeknews.base.contract.zhihu.ThemeChildContract;\nimport com.codeest.geeknews.util.RxUtil;\nimport com.codeest.geeknews.widget.CommonSubscriber;\n\nimport java.util.List;\n\nimport javax.inject.Inject;\n\nimport io.reactivex.functions.Function;\n\n/**\n * Created by codeest on 16/8/24.\n */\n\npublic class ThemeChildPresenter extends RxPresenter<ThemeChildContract.View> implements ThemeChildContract.Presenter{\n\n    private DataManager mDataManager;\n\n    @Inject\n    public ThemeChildPresenter(DataManager mDataManager) {\n        this.mDataManager = mDataManager;\n    }\n\n    @Override\n    public void getThemeChildData(int id) {\n        addSubscribe(mDataManager.fetchThemeChildListInfo(id)\n                .compose(RxUtil.<ThemeChildListBean>rxSchedulerHelper())\n                .map(new Function<ThemeChildListBean, ThemeChildListBean>() {\n                    @Override\n                    public ThemeChildListBean apply(ThemeChildListBean themeChildListBean) {\n                        List<ThemeChildListBean.StoriesBean> list = themeChildListBean.getStories();\n                        for(ThemeChildListBean.StoriesBean item : list) {\n                            item.setReadState(mDataManager.queryNewsId(item.getId()));\n                        }\n                        return themeChildListBean;\n                    }\n                })\n                .subscribeWith(new CommonSubscriber<ThemeChildListBean>(mView) {\n                    @Override\n                    public void onNext(ThemeChildListBean themeChildListBean) {\n                        mView.showContent(themeChildListBean);\n                    }\n                })\n        );\n    }\n\n    @Override\n    public void insertReadToDB(int id) {\n        mDataManager.insertNewsId(id);\n    }\n}\n'