b'package com.codeest.geeknews.app;\r\n\r\nimport android.app.Activity;\r\nimport android.app.Application;\r\nimport android.content.Context;\r\nimport android.support.multidex.MultiDex;\r\nimport android.support.v7.app.AppCompatDelegate;\r\nimport android.util.DisplayMetrics;\r\nimport android.view.Display;\r\nimport android.view.WindowManager;\r\n\r\nimport com.codeest.geeknews.component.InitializeService;\r\nimport com.codeest.geeknews.di.component.AppComponent;\r\nimport com.codeest.geeknews.di.component.DaggerAppComponent;\r\nimport com.codeest.geeknews.di.module.AppModule;\r\nimport com.codeest.geeknews.di.module.HttpModule;\r\n\r\nimport java.util.HashSet;\r\nimport java.util.Set;\r\n\r\nimport io.realm.Realm;\r\n\r\n/**\r\n * Created by codeest on 2016/8/2.\r\n */\r\npublic class App extends Application{\r\n\r\n    private static App instance;\r\n    public static AppComponent appComponent;\r\n    private Set<Activity> allActivities;\r\n\r\n    public static int SCREEN_WIDTH = -1;\r\n    public static int SCREEN_HEIGHT = -1;\r\n    public static float DIMEN_RATE = -1.0F;\r\n    public static int DIMEN_DPI = -1;\r\n\r\n    public static synchronized App getInstance() {\r\n        return instance;\r\n    }\r\n\r\n    static {\r\n        AppCompatDelegate.setDefaultNightMode(\r\n                AppCompatDelegate.MODE_NIGHT_NO);\r\n    }\r\n\r\n    @Override\r\n    public void onCreate() {\r\n        super.onCreate();\r\n        instance = this;\r\n\r\n        //\xe5\x88\x9d\xe5\xa7\x8b\xe5\x8c\x96\xe5\xb1\x8f\xe5\xb9\x95\xe5\xae\xbd\xe9\xab\x98\r\n        getScreenSize();\r\n\r\n        //\xe5\x88\x9d\xe5\xa7\x8b\xe5\x8c\x96\xe6\x95\xb0\xe6\x8d\xae\xe5\xba\x93\r\n        Realm.init(getApplicationContext());\r\n\r\n        //\xe5\x9c\xa8\xe5\xad\x90\xe7\xba\xbf\xe7\xa8\x8b\xe4\xb8\xad\xe5\xae\x8c\xe6\x88\x90\xe5\x85\xb6\xe4\xbb\x96\xe5\x88\x9d\xe5\xa7\x8b\xe5\x8c\x96\r\n        InitializeService.start(this);\r\n    }\r\n\r\n    protected void attachBaseContext(Context base) {\r\n        super.attachBaseContext(base);\r\n        MultiDex.install(this);\r\n    }\r\n\r\n    public void addActivity(Activity act) {\r\n        if (allActivities == null) {\r\n            allActivities = new HashSet<>();\r\n        }\r\n        allActivities.add(act);\r\n    }\r\n\r\n    public void removeActivity(Activity act) {\r\n        if (allActivities != null) {\r\n            allActivities.remove(act);\r\n        }\r\n    }\r\n\r\n    public void exitApp() {\r\n        if (allActivities != null) {\r\n            synchronized (allActivities) {\r\n                for (Activity act : allActivities) {\r\n                    act.finish();\r\n                }\r\n            }\r\n        }\r\n        android.os.Process.killProcess(android.os.Process.myPid());\r\n        System.exit(0);\r\n    }\r\n\r\n    public void getScreenSize() {\r\n        WindowManager windowManager = (WindowManager)this.getSystemService(Context.WINDOW_SERVICE);\r\n        DisplayMetrics dm = new DisplayMetrics();\r\n        Display display = windowManager.getDefaultDisplay();\r\n        display.getMetrics(dm);\r\n        DIMEN_RATE = dm.density / 1.0F;\r\n        DIMEN_DPI = dm.densityDpi;\r\n        SCREEN_WIDTH = dm.widthPixels;\r\n        SCREEN_HEIGHT = dm.heightPixels;\r\n        if(SCREEN_WIDTH > SCREEN_HEIGHT) {\r\n            int t = SCREEN_HEIGHT;\r\n            SCREEN_HEIGHT = SCREEN_WIDTH;\r\n            SCREEN_WIDTH = t;\r\n        }\r\n    }\r\n\r\n    public static AppComponent getAppComponent(){\r\n        if (appComponent == null) {\r\n            appComponent = DaggerAppComponent.builder()\r\n                    .appModule(new AppModule(instance))\r\n                    .httpModule(new HttpModule())\r\n                    .build();\r\n        }\r\n        return appComponent;\r\n    }\r\n}\r\n'