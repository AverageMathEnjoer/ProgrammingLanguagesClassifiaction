b'package com.naman14.timber.dialogs;\n\nimport android.app.Dialog;\nimport android.app.DialogFragment;\nimport android.app.ProgressDialog;\nimport android.os.Bundle;\nimport androidx.annotation.NonNull;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\nimport com.afollestad.materialdialogs.DialogAction;\nimport com.afollestad.materialdialogs.MaterialDialog;\nimport com.naman14.timber.R;\nimport com.naman14.timber.fragments.SettingsFragment;\nimport com.naman14.timber.lastfmapi.LastFmClient;\nimport com.naman14.timber.lastfmapi.callbacks.UserListener;\nimport com.naman14.timber.lastfmapi.models.UserLoginQuery;\n\n/**\n * Created by christoph on 17.07.16.\n */\npublic class LastFmLoginDialog extends DialogFragment {\n    public static final String FRAGMENT_NAME = "LastFMLogin";\n\n    @Override\n    public Dialog onCreateDialog(Bundle savedInstanceState) {\n        return new MaterialDialog.Builder(getActivity()).\n                positiveText("Login").\n                negativeText(getString(R.string.cancel)).\n                title(getString(R.string.lastfm_login)).\n                customView(R.layout.dialog_lastfm_login, false).\n                onPositive(new MaterialDialog.SingleButtonCallback() {\n                    @Override\n                    public void onClick(@NonNull MaterialDialog dialog, @NonNull DialogAction which) {\n                        String username = ((EditText) dialog.findViewById(R.id.lastfm_username)).getText().toString();\n                        String password = ((EditText) dialog.findViewById(R.id.lastfm_password)).getText().toString();\n                        if (username.length() == 0 || password.length() == 0) return;\n                        final ProgressDialog progressDialog = new ProgressDialog(getActivity());\n                        progressDialog.setMessage("Logging in..");\n                        progressDialog.show();\n                        LastFmClient.getInstance(getActivity()).getUserLoginInfo(new UserLoginQuery(username, password), new UserListener() {\n\n                            @Override\n                            public void userSuccess() {\n                                progressDialog.dismiss();\n                                if (getTargetFragment() instanceof SettingsFragment) {\n                                    ((SettingsFragment) getTargetFragment()).updateLastFM();\n                                }\n                            }\n\n                            @Override\n                            public void userInfoFailed() {\n                                progressDialog.dismiss();\n                                Toast.makeText(getTargetFragment().getActivity(), getString(R.string.lastfm_login_failture), Toast.LENGTH_SHORT).show();\n                            }\n                        });\n                    }\n                }).build();\n    }\n}\n'