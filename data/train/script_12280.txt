b'\xef\xbb\xbfusing Rubeus.Ndr.Marshal;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing Rubeus.Ndr;\n\nnamespace Rubeus.Kerberos.PAC {\n    public class LogonInfo : PacInfoBuffer {\n\n        public _KERB_VALIDATION_INFO KerbValidationInfo { get; set; }\n\n        public LogonInfo()\n        {\n            Type = PacInfoBufferType.LogonInfo;\n        }\n\n        public LogonInfo(_KERB_VALIDATION_INFO kerbValidationInfo) : this() {\n            KerbValidationInfo = kerbValidationInfo;\n        }\n\n        public LogonInfo(byte[] data) : base(data, PacInfoBufferType.LogonInfo) {\n            Decode(data);\n        }\n        \n        public override byte[] Encode() {\n            _Marshal_Helper mh = new _Marshal_Helper();\n            mh.WriteReferent(KerbValidationInfo, new Action<_KERB_VALIDATION_INFO>(mh.WriteStruct));\n            return mh.ToPickledType().ToArray();            \n        }\n\n        protected override void Decode(byte[] data) {\n            NdrPickledType npt = new NdrPickledType(data);\n            _Unmarshal_Helper uh = new _Unmarshal_Helper(npt.Data);\n            KerbValidationInfo = (_KERB_VALIDATION_INFO)uh.ReadReferentValue(uh.ReadStruct<_KERB_VALIDATION_INFO>, false);\n        }\n    }\n}\n'