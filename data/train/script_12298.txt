b'package com.droidcba.kedditbysteps.commons\n\nimport android.support.v7.widget.LinearLayoutManager\nimport android.support.v7.widget.RecyclerView\nimport android.util.Log\n\nclass InfiniteScrollListener(\n        val func: () -> Unit,\n        val layoutManager: LinearLayoutManager) : RecyclerView.OnScrollListener() {\n\n    private var previousTotal = 0\n    private var loading = true\n    private var visibleThreshold = 2\n    private var firstVisibleItem = 0\n    private var visibleItemCount = 0\n    private var totalItemCount = 0\n\n    override fun onScrolled(recyclerView: RecyclerView, dx: Int, dy: Int) {\n        super.onScrolled(recyclerView, dx, dy)\n\n        if (dy > 0) {\n            visibleItemCount = recyclerView.childCount\n            totalItemCount = layoutManager.itemCount\n            firstVisibleItem = layoutManager.findFirstVisibleItemPosition()\n\n            if (loading) {\n                if (totalItemCount > previousTotal) {\n                    loading = false\n                    previousTotal = totalItemCount\n                }\n            }\n            if (!loading && (totalItemCount - visibleItemCount)\n                    <= (firstVisibleItem + visibleThreshold)) {\n                // End has been reached\n                Log.i("InfiniteScrollListener", "End reached")\n                func()\n                loading = true\n            }\n        }\n    }\n\n}'