b'package com.zzg.mybatis.generator.controller;\r\n\r\nimport com.zzg.mybatis.generator.view.AlertUtil;\r\nimport javafx.fxml.FXMLLoader;\r\nimport javafx.fxml.Initializable;\r\nimport javafx.scene.Parent;\r\nimport javafx.scene.Scene;\r\nimport javafx.stage.Modality;\r\nimport javafx.stage.Stage;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\n\r\nimport java.io.IOException;\r\nimport java.lang.ref.SoftReference;\r\nimport java.net.URL;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic abstract class BaseFXController implements Initializable {\r\n    private static final Logger _LOG = LoggerFactory.getLogger(BaseFXController.class);\r\n\r\n    private Stage primaryStage;\r\n    private Stage dialogStage;\r\n\r\n    private static Map<FXMLPage, SoftReference<? extends BaseFXController>> cacheNodeMap = new HashMap<>();\r\n\r\n    public BaseFXController loadFXMLPage(String title, FXMLPage fxmlPage, boolean cache) {\r\n        SoftReference<? extends BaseFXController> parentNodeRef = cacheNodeMap.get(fxmlPage);\r\n        if (cache && parentNodeRef != null) {\r\n            return parentNodeRef.get();\r\n        }\r\n        URL skeletonResource = Thread.currentThread().getContextClassLoader().getResource(fxmlPage.getFxml());\r\n        FXMLLoader loader = new FXMLLoader(skeletonResource);\r\n        Parent loginNode;\r\n        try {\r\n            loginNode = loader.load();\r\n            BaseFXController controller     = loader.getController();\r\n            // fix bug: \xe5\xb5\x8c\xe5\xa5\x97\xe5\xbc\xb9\xe5\x87\xba\xe6\x97\xb6\xe4\xbc\x9a\xe5\x8f\x91\xe7\x94\x9fdialogStage\xe8\xa2\xab\xe8\xa6\x86\xe7\x9b\x96\xe7\x9a\x84\xe6\x83\x85\xe5\x86\xb5\r\n            Stage            tmpDialogStage = new Stage();\r\n            tmpDialogStage.setTitle(title);\r\n            tmpDialogStage.initModality(Modality.APPLICATION_MODAL);\r\n            tmpDialogStage.initOwner(getPrimaryStage());\r\n            tmpDialogStage.setScene(new Scene(loginNode));\r\n            tmpDialogStage.setMaximized(false);\r\n            tmpDialogStage.setResizable(false);\r\n            tmpDialogStage.show();\r\n            controller.setDialogStage(tmpDialogStage);\r\n            // put into cache map\r\n            SoftReference<BaseFXController> softReference = new SoftReference<>(controller);\r\n            cacheNodeMap.put(fxmlPage, softReference);\r\n\r\n            return controller;\r\n        } catch (IOException e) {\r\n            _LOG.error(e.getMessage(), e);\r\n            AlertUtil.showErrorAlert(e.getMessage());\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public Stage getPrimaryStage() {\r\n        return primaryStage;\r\n    }\r\n\r\n    public void setPrimaryStage(Stage primaryStage) {\r\n        this.primaryStage = primaryStage;\r\n    }\r\n\r\n    public Stage getDialogStage() {\r\n        return dialogStage;\r\n    }\r\n\r\n    public void setDialogStage(Stage dialogStage) {\r\n        this.dialogStage = dialogStage;\r\n    }\r\n\r\n    public void showDialogStage() {\r\n        if (dialogStage != null) {\r\n            dialogStage.show();\r\n        }\r\n    }\r\n\r\n    public void closeDialogStage() {\r\n        if (dialogStage != null) {\r\n            dialogStage.close();\r\n        }\r\n    }\r\n\r\n}\r\n'