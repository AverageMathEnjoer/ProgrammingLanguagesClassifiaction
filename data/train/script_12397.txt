b'// UVa1609  Foul Play\n// Rujia Liu\n\n#include<cstdio>\n#include<vector>\nusing namespace std;\n\nconst int maxn = 1024 + 5;\nchar table[maxn][maxn];\n\nint main() {\n  int n;\n  while(scanf("%d", &n) == 1) {\n    for(int i = 1; i <= n; i++) scanf("%s", table[i]+1);\n\n    vector<int> win, lose; // teams that team 1 win/lose against.\n    for(int i = 2; i <= n; i++)\n      if(table[1][i] == \'1\') win.push_back(i);\n      else lose.push_back(i);\n\n    int nt = n;\n    while(nt > 1) {\n      vector<int> win2, lose2, final; // phase 3/4\n\n      // Phase 1\n      for(int i = 0; i < lose.size(); i++) {\n        int tlose = lose[i];\n        bool matched = false;\n        for(int j = 0; j < win.size(); j++) {\n          int& twin = win[j];\n          if(twin > 0 && table[twin][tlose] == \'1\') {\n            printf("%d %d\\n", twin, tlose);\n            win2.push_back(twin); // go to the next round\n            twin = 0; // not available\n            matched = true;\n            break;\n          }\n        }\n        if(!matched) final.push_back(tlose); // to phase 3/4\n      }\n\n      // Phase 2\n      bool first = true;\n      for(int i = 0; i < win.size(); i++) {\n        int twin = win[i];\n        if(twin > 0) {\n          if(first) { printf("1 %d\\n", twin); first = false; }\n          else final.push_back(twin);\n        }\n      }\n\n      // Phase 3/4\n      for(int i = 0; i < final.size(); i += 2) {\n        printf("%d %d\\n", final[i], final[i+1]);\n        int keep = final[i];\n        if(table[final[i+1]][keep] == \'1\') keep = final[i+1];\n        if(table[1][keep] == \'1\') win2.push_back(keep);\n        else lose2.push_back(keep);\n      }\n      win = win2;\n      lose = lose2;\n      nt >>= 1;\n    }\n  }\n  return 0;\n}\n'