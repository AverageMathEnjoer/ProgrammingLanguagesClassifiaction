b'package com.codeest.geeknews.ui.main.fragment;\n\nimport android.support.v7.widget.LinearLayoutManager;\nimport android.support.v7.widget.RecyclerView;\nimport android.support.v7.widget.helper.ItemTouchHelper;\n\nimport com.codeest.geeknews.R;\nimport com.codeest.geeknews.base.BaseFragment;\nimport com.codeest.geeknews.model.bean.RealmLikeBean;\nimport com.codeest.geeknews.presenter.main.LikePresenter;\nimport com.codeest.geeknews.base.contract.main.LikeContract;\nimport com.codeest.geeknews.ui.main.adapter.LikeAdapter;\nimport com.codeest.geeknews.util.SnackbarUtil;\nimport com.codeest.geeknews.widget.DefaultItemTouchHelpCallback;\n\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.List;\n\nimport butterknife.BindView;\n\n/**\n * Created by codeest on 16/8/23.\n */\n\npublic class LikeFragment extends BaseFragment<LikePresenter> implements LikeContract.View {\n\n    @BindView(R.id.rv_like_list)\n    RecyclerView rvLikeList;\n\n    LikeAdapter mAdapter;\n    List<RealmLikeBean> mList;\n    DefaultItemTouchHelpCallback mCallback;\n\n    @Override\n    protected void initInject() {\n        getFragmentComponent().inject(this);\n    }\n\n    @Override\n    protected int getLayoutId() {\n        return R.layout.fragment_like;\n    }\n\n    @Override\n    protected void initEventAndData() {\n        mList = new ArrayList<>();\n        mAdapter = new LikeAdapter(mContext, mList);\n        rvLikeList.setLayoutManager(new LinearLayoutManager(mContext));\n        rvLikeList.setAdapter(mAdapter);\n        mCallback = new DefaultItemTouchHelpCallback(new DefaultItemTouchHelpCallback.OnItemTouchCallbackListener() {\n            @Override\n            public void onSwiped(int adapterPosition) {\n                // \xe6\xbb\x91\xe5\x8a\xa8\xe5\x88\xa0\xe9\x99\xa4\xe7\x9a\x84\xe6\x97\xb6\xe5\x80\x99\xef\xbc\x8c\xe4\xbb\x8e\xe6\x95\xb0\xe6\x8d\xae\xe5\xba\x93\xe3\x80\x81\xe6\x95\xb0\xe6\x8d\xae\xe6\xba\x90\xe7\xa7\xbb\xe9\x99\xa4\xef\xbc\x8c\xe5\xb9\xb6\xe5\x88\xb7\xe6\x96\xb0UI\n                if (mList != null) {\n                    mPresenter.deleteLikeData(mList.get(adapterPosition).getId());\n                    mList.remove(adapterPosition);\n                    mAdapter.notifyItemRemoved(adapterPosition);\n                }\n            }\n\n            @Override\n            public boolean onMove(int srcPosition, int targetPosition) {\n                if (mList != null) {\n                    // \xe6\x9b\xb4\xe6\x8d\xa2\xe6\x95\xb0\xe6\x8d\xae\xe5\xba\x93\xe4\xb8\xad\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xaeItem\xe7\x9a\x84\xe4\xbd\x8d\xe7\xbd\xae\n                    boolean isPlus = srcPosition < targetPosition;\n                    mPresenter.changeLikeTime(mList.get(srcPosition).getId(),mList.get(targetPosition).getTime(),isPlus);\n                    // \xe6\x9b\xb4\xe6\x8d\xa2\xe6\x95\xb0\xe6\x8d\xae\xe6\xba\x90\xe4\xb8\xad\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xaeItem\xe7\x9a\x84\xe4\xbd\x8d\xe7\xbd\xae\n                    Collections.swap(mList, srcPosition, targetPosition);\n                    // \xe6\x9b\xb4\xe6\x96\xb0UI\xe4\xb8\xad\xe7\x9a\x84Item\xe7\x9a\x84\xe4\xbd\x8d\xe7\xbd\xae\xef\xbc\x8c\xe4\xb8\xbb\xe8\xa6\x81\xe6\x98\xaf\xe7\xbb\x99\xe7\x94\xa8\xe6\x88\xb7\xe7\x9c\x8b\xe5\x88\xb0\xe4\xba\xa4\xe4\xba\x92\xe6\x95\x88\xe6\x9e\x9c\n                    mAdapter.notifyItemMoved(srcPosition, targetPosition);\n                    return true;\n                }\n                return false;\n            }\n        });\n        mCallback.setDragEnable(true);\n        mCallback.setSwipeEnable(true);\n        ItemTouchHelper itemTouchHelper = new ItemTouchHelper(mCallback);\n        itemTouchHelper.attachToRecyclerView(rvLikeList);\n        mPresenter.getLikeData();\n    }\n\n    @Override\n    public void onHiddenChanged(boolean hidden) {\n        super.onHiddenChanged(hidden);\n        if (!hidden) {\n            mPresenter.getLikeData();\n            if (!mPresenter.getLikePoint()) {\n                SnackbarUtil.show(rvLikeList,"\xe6\x94\xaf\xe6\x8c\x81\xe4\xbe\xa7\xe6\xbb\x91\xe5\x88\xa0\xe9\x99\xa4\xef\xbc\x8c\xe9\x95\xbf\xe6\x8c\x89\xe6\x8b\x96\xe6\x9b\xb3\xe5\x93\xa6(\xe3\x80\x82\xe3\x83\xbb`\xcf\x89\xc2\xb4\xe3\x83\xbb)");\n                mPresenter.setLikePoint(true);\n            }\n        }\n    }\n\n    @Override\n    public void onResume() {\n        super.onResume();\n        if (isInited) {\n            mPresenter.getLikeData();\n        }\n    }\n\n    @Override\n    public void showContent(List<RealmLikeBean> list) {\n        mList.clear();\n        mList.addAll(list);\n        mAdapter.notifyDataSetChanged();\n    }\n}\n'