b'//sliding window maximum\n//https://people.cs.uct.ac.za/~ksmith/articles/sliding_window_minimum.html\n//http://codeforces.com/problemset/problem/372/C\n#include <bits/stdc++.h>\nusing namespace std;\n#define gc getchar_unlocked\n#define fo(i,n) for(i=0;i<n;i++)\n#define Fo(i,k,n) for(i=k;k<n?i<n:i>n;k<n?i+=1:i-=1)\n#define ll long long\n#define si(x)\tscanf("%d",&x)\n#define sl(x)\tscanf("%lld",&x)\n#define ss(s)\tscanf("%s",s)\n#define pi(x)\tprintf("%d\\n",x)\n#define pl(x)\tprintf("%lld\\n",x)\n#define ps(s)\tprintf("%s\\n",s)\n#define pb push_back\n#define mp make_pair\n#define F first\n#define S second\n#define all(x) x.begin(), x.end()\n#define clr(x) memset(x, 0, sizeof(x))\n#define sortall(x) sort(all(x))\n#define tr(it, a) for(auto it = a.begin(); it != a.end(); it++)\n#define PI 3.1415926535897932384626\ntypedef pair<int, int>\tpii;\ntypedef pair<ll, ll>\tpll;\ntypedef vector<int>\t\tvi;\ntypedef vector<ll>\t\tvll;\ntypedef vector<pii>\t\tvpii;\ntypedef vector<pll>\t\tvpll;\ntypedef vector<vi>\t\tvvi;\ntypedef vector<vll>\t\tvvl;\nconst int mod = 1000000007;\nconst int N = 3e5;\nvi g[N];\nll a[N], b[N], t[N];\nll dp[3][N];\nint main()\n{\n\tios_base::sync_with_stdio(false);\n\tcin.tie(NULL);\n\tint i,n,k,j,m,d;\n\tcin>>n>>m>>d;\n\tfo(i, m) cin>>a[i]>>b[i]>>t[i];\n\tint cur = 1, pre = 0;\n\tFo(i, 1, n+1)\n\t\tdp[cur][i] = b[m-1]-abs(a[m-1]-i);\n\tswap(cur, pre);\n\tFo(i, m-2, -1){\n\t\tdeque<pll> window;\n\t\tll dt = t[i+1]-t[i];\n\t\tdt *= d;\n\t\tk = min(n-1LL, dt);\n\t\t//moving from right to left\n\t\t//initially install [n-k+1, n] \n\t\t//j-k to j+k\n\t\tFo(j, n, n-k){\n\t\t\twhile(!window.empty() and window.back().F <= dp[pre][j])\n\t\t\t\twindow.pop_back();\t\n\t\t\twindow.pb({dp[pre][j], j});\n\t\t}\n\t\tFo(j, n, 0){\n\t\t\t\n\t\t\tint x = j-k;\n\t\t\t//add j-k to window\n\t\t\tif (x>0) {\n\t\t\t\twhile(!window.empty() and window.back().F <= dp[pre][x])\n\t\t\t\t\twindow.pop_back();\n\t\t\t\twindow.pb({dp[pre][x], x});\n\t\t\t}\n\t\t\t//remove elements at pos > j+k\n\t\t\twhile(!window.empty() and window.front().S > j+k) window.pop_front();\n\t\t\tdp[cur][j] = b[i]-abs(a[i]-j) + window.front().F;\n\t\t}\n\t\tswap(cur, pre);\n\t}\n\tll ans = -1e17;\n\tFo(i, 1, n+1) ans = max(ans, dp[pre][i]);\n\tcout<<ans<<endl;\n\treturn 0;\n} \n\n'