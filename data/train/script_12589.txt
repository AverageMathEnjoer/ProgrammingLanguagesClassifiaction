b'package com.codeest.geeknews.ui.vtex.activity;\n\nimport android.content.res.XmlResourceParser;\nimport android.support.v4.util.ArrayMap;\nimport android.support.v7.widget.LinearLayoutManager;\nimport android.support.v7.widget.RecyclerView;\nimport android.support.v7.widget.Toolbar;\nimport android.view.View;\nimport android.widget.TextView;\n\nimport com.codeest.geeknews.R;\nimport com.codeest.geeknews.base.SimpleActivity;\nimport com.codeest.geeknews.ui.vtex.adapter.NodeAdapter;\nimport com.codeest.geeknews.util.XmlUtil;\n\nimport butterknife.BindView;\n\n/**\n * Created by codeest on 16/12/19.\n */\n\npublic class NodeActivity extends SimpleActivity {\n\n    NodeAdapter mAdapter;\n    @BindView(R.id.tool_bar)\n    Toolbar toolBar;\n    @BindView(R.id.rv_content)\n    RecyclerView rvContent;\n    @BindView(R.id.tv_node_title)\n    TextView tvNodeTitle;\n\n    private LinearLayoutManager mManager;\n    private ArrayMap<String, ArrayMap<String,String>> map;\n    private int mTitleHeight;\n    private int mCurrentPosition;\n\n    @Override\n    protected int getLayout() {\n        return R.layout.activity_node;\n    }\n\n    @Override\n    protected void initEventAndData() {\n        setToolBar(toolBar, "\xe8\x8a\x82\xe7\x82\xb9\xe5\xaf\xbc\xe8\x88\xaa");\n        XmlResourceParser xmlParser = this.getResources().getXml(R.xml.nodes);\n        try {\n            map = XmlUtil.parseNodes(xmlParser);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        mAdapter = new NodeAdapter(mContext , map);\n        mManager = new LinearLayoutManager(mContext);\n        rvContent.setLayoutManager(mManager);\n        rvContent.setAdapter(mAdapter);\n        rvContent.addOnScrollListener(new RecyclerView.OnScrollListener() {\n            @Override\n            public void onScrollStateChanged(RecyclerView recyclerView, int newState) {\n                super.onScrollStateChanged(recyclerView, newState);\n                mTitleHeight = tvNodeTitle.getHeight();\n            }\n\n            @Override\n            public void onScrolled(RecyclerView recyclerView, int dx, int dy) {\n                super.onScrolled(recyclerView, dx, dy);\n                View view = mManager.findViewByPosition(mCurrentPosition + 1);\n                if (view != null) {\n                    if (view.getTop() <= mTitleHeight) {\n                        tvNodeTitle.setY(-(mTitleHeight - view.getTop()));\n                    } else {\n                        tvNodeTitle.setY(0);\n                    }\n                }\n                if (mCurrentPosition != mManager.findFirstVisibleItemPosition()) {\n                    mCurrentPosition = mManager.findFirstVisibleItemPosition();\n                    tvNodeTitle.setY(0);\n                    if (map != null) {\n                        tvNodeTitle.setText(map.keyAt(mCurrentPosition));\n                    }\n                }\n            }\n        });\n        tvNodeTitle.setText(map.keyAt(0));\n    }\n}\n'