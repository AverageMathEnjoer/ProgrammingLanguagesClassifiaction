b'\xef\xbb\xbfusing System;\nusing Asn1;\nusing System.Text;\nusing System.Collections.Generic;\n\nnamespace Rubeus\n{\n    public class Checksum\n    {\n        //Checksum        ::= SEQUENCE {\n        //        cksumtype       [0] Int32,\n        //        checksum        [1] OCTET STRING\n        //}\n\n        public Checksum(byte[] data)\n        {\n            // KERB_CHECKSUM_HMAC_MD5 = -138\n            cksumtype = -138;\n\n            checksum = data;\n        }\n\n        public Checksum(Interop.KERB_CHECKSUM_ALGORITHM cktype, byte[] data)\n        {\n            cksumtype = (int)cktype;\n\n            checksum = data;\n        }\n\n        public Checksum(AsnElt body)\n        {\n            foreach (AsnElt s in body.Sub)\n            {\n                switch (s.TagValue)\n                {\n                    case 0:\n                        cksumtype = Convert.ToInt32(s.Sub[0].GetInteger());\n                        break;\n                    case 2:\n                        checksum = s.Sub[0].GetOctetString();\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n\n        public AsnElt Encode()\n        {\n            // cksumtype       [0] Int32\n            AsnElt cksumtypeAsn = AsnElt.MakeInteger(cksumtype);\n            AsnElt cksumtypeSeq = AsnElt.Make(AsnElt.SEQUENCE, new AsnElt[] { cksumtypeAsn });\n            cksumtypeSeq = AsnElt.MakeImplicit(AsnElt.CONTEXT, 0, cksumtypeSeq);\n\n\n            // checksum        [1] OCTET STRING\n            AsnElt checksumAsn = AsnElt.MakeBlob(checksum);\n            AsnElt checksumSeq = AsnElt.Make(AsnElt.SEQUENCE, new AsnElt[] { checksumAsn });\n            checksumSeq = AsnElt.MakeImplicit(AsnElt.CONTEXT, 1, checksumSeq);\n\n\n            AsnElt totalSeq = AsnElt.Make(AsnElt.SEQUENCE, new AsnElt[] { cksumtypeSeq, checksumSeq });\n            AsnElt totalSeq2 = AsnElt.Make(AsnElt.SEQUENCE, new AsnElt[] { totalSeq });\n            return totalSeq2;\n        }\n\n        public Int32 cksumtype { get; set; }\n\n        public byte[] checksum { get; set; }\n    }\n}'