b'\xef\xbb\xbf// UVa116 Unidirectional TSP\n// Rujia Liu\n// \xe7\xae\x97\xe6\xb3\x95\xef\xbc\x9a\xe5\xa4\x9a\xe6\xae\xb5\xe5\x9b\xbe\xe7\x9a\x84\xe5\x8a\xa8\xe6\x80\x81\xe8\xa7\x84\xe5\x88\x92\xe3\x80\x82\xe5\x9b\xa0\xe4\xb8\xba\xe8\xa6\x81\xe5\xad\x97\xe5\x85\xb8\xe5\xba\x8f\xe6\x9c\x80\xe5\xb0\x8f\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe5\x80\x92\xe7\x9d\x80\xe6\x9d\xa5\xef\xbc\x8c\xe8\xae\xbed[i][j]\xe4\xb8\xba\xe4\xbb\x8e(i,j)\xe5\x88\xb0\xe6\x9c\x80\xe5\x90\x8e\xe4\xb8\x80\xe5\x88\x97\xe7\x9a\x84\xe6\x9c\x80\xe5\xb0\x8f\xe5\xbc\x80\xe9\x94\x80\xef\xbc\x8c\xe5\x88\x99d[i][j]=a[i][j]+max(d[i+1][j+1],d[i-1][j+1])\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\nconst int maxn = 100 + 5;\nconst int INF = 1000000000;\nint m, n, a[maxn][maxn], d[maxn][maxn], next[maxn][maxn];\n\nint main() {\n  while(scanf("%d%d", &m, &n) == 2 && m) {\n    for(int i = 0; i < m; i++)\n      for(int j = 0; j < n; j++)\n        scanf("%d", &a[i][j]);\n\n    int ans = INF, first = 0;\n    for(int j = n-1; j >= 0; j--) {\n      for(int i = 0; i < m; i++) {\n        if(j == n-1) d[i][j] = a[i][j];\n        else {\n          int rows[3] = {i, i-1, i+1};\n          if(i == 0) rows[1] = m-1;\n          if(i == m-1) rows[2] = 0;\n          sort(rows, rows+3);\n          d[i][j] = INF;\n          for(int k = 0; k < 3; k++) {\n            int v = d[rows[k]][j+1] + a[i][j];\n            if(v < d[i][j]) { d[i][j] = v; next[i][j] = rows[k]; }\n          }\n        }\n        if(j == 0 && d[i][j] < ans) { ans = d[i][j]; first = i; }\n      }\n    }\n    printf("%d", first+1);\n    for(int i = next[first][0], j = 1; j < n; i = next[i][j], j++) printf(" %d", i+1);\n    printf("\\n%d\\n", ans);\n  }\n  return 0;\n}\n'