b'{-# LANGUAGE NoImplicitPrelude #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE OverloadedStrings #-}\n\n{-\n\nWrite a function (dollars) that accepts a `String` and returns a `String`.\nIt will accept a numeric value as input, representing an amount of money, and convert to its transcribed English.\n\nFor example, the input "1.11" will result in a return value of "one dollar and eleven cents"\n\nInvalid characters should be ignored, meaning that every input string has an output string.\nThe empty string produces "zero dollars and zero cents"\n\nThere is a `test` function below that lists more examples of input and output. There are also functions and\ndata structures that may assist you in deriving the result. It is not compulsory that they are used.\n\n-}\n\nmodule Course.Cheque where\n\nimport Course.Core\nimport Course.Optional\nimport Course.List\nimport Course.Functor\nimport Course.Applicative\nimport Course.Monad\n\n-- $setup\n-- >>> :set -XOverloadedStrings\n\n-- The representation of the grouping of each exponent of one thousand. ["thousand", "million", ...]\nillion ::\n  List Chars\nillion =\n  let preillion ::\n        List (Chars -> Chars)\n      preillion =\n        listh [\n          const ""\n        , const "un"\n        , const "do"\n        , const "tre"\n        , const "quattuor"\n        , const "quin"\n        , const "sex"\n        , const "septen"\n        , const "octo"\n        , \\q -> if "n" `isPrefixOf` q then "novem" else "noven"\n        ]\n      postillion ::\n        List Chars\n      postillion =\n        listh [\n          "vigintillion"\n        , "trigintillion"\n        , "quadragintillion"\n        , "quinquagintillion"\n        , "sexagintillion"\n        , "septuagintillion"\n        , "octogintillion"\n        , "nonagintillion"\n        , "centillion"\n        , "decicentillion"\n        , "viginticentillion"\n        , "trigintacentillion"\n        , "quadragintacentillion"\n        , "quinquagintacentillion"\n        , "sexagintacentillion"\n        , "septuagintacentillion"\n        , "octogintacentillion"\n        , "nonagintacentillion"\n        , "ducentillion"\n        , "deciducentillion"\n        , "vigintiducentillion"\n        , "trigintaducentillion"\n        , "quadragintaducentillion"\n        , "quinquagintaducentillion"\n        , "sexagintaducentillion"\n        , "septuagintaducentillion"\n        , "octogintaducentillion"\n        , "nonagintaducentillion"\n        , "trecentillion"\n        , "decitrecentillion"\n        , "vigintitrecentillion"\n        , "trigintatrecentillion"\n        , "quadragintatrecentillion"\n        , "quinquagintatrecentillion"\n        , "sexagintatrecentillion"\n        , "septuagintatrecentillion"\n        , "octogintatrecentillion"\n        , "nonagintatrecentillion"\n        , "quadringentillion"\n        , "deciquadringentillion"\n        , "vigintiquadringentillion"\n        , "trigintaquadringentillion"\n        , "quadragintaquadringentillion"\n        , "quinquagintaquadringentillion"\n        , "sexagintaquadringentillion"\n        , "septuagintaquadringentillion"\n        , "octogintaquadringentillion"\n        , "nonagintaquadringentillion"\n        , "quingentillion"\n        , "deciquingentillion"\n        , "vigintiquingentillion"\n        , "trigintaquingentillion"\n        , "quadragintaquingentillion"\n        , "quinquagintaquingentillion"\n        , "sexagintaquingentillion"\n        , "septuagintaquingentillion"\n        , "octogintaquingentillion"\n        , "nonagintaquingentillion"\n        , "sescentillion"\n        , "decisescentillion"\n        , "vigintisescentillion"\n        , "trigintasescentillion"\n        , "quadragintasescentillion"\n        , "quinquagintasescentillion"\n        , "sexagintasescentillion"\n        , "septuagintasescentillion"\n        , "octogintasescentillion"\n        , "nonagintasescentillion"\n        , "septingentillion"\n        , "deciseptingentillion"\n        , "vigintiseptingentillion"\n        , "trigintaseptingentillion"\n        , "quadragintaseptingentillion"\n        , "quinquagintaseptingentillion"\n        , "sexagintaseptingentillion"\n        , "septuagintaseptingentillion"\n        , "octogintaseptingentillion"\n        , "nonagintaseptingentillion"\n        , "octingentillion"\n        , "decioctingentillion"\n        , "vigintioctingentillion"\n        , "trigintaoctingentillion"\n        , "quadragintaoctingentillion"\n        , "quinquagintaoctingentillion"\n        , "sexagintaoctingentillion"\n        , "septuagintaoctingentillion"\n        , "octogintaoctingentillion"\n        , "nonagintaoctingentillion"\n        , "nongentillion"\n        , "decinongentillion"\n        , "vigintinongentillion"\n        , "trigintanongentillion"\n        , "quadragintanongentillion"\n        , "quinquagintanongentillion"\n        , "sexagintanongentillion"\n        , "septuagintanongentillion"\n        , "octogintanongentillion"\n        , "nonagintanongentillion"\n        ]\n  in listh [\n       ""\n     , "thousand"\n     , "million"\n     , "billion"\n     , "trillion"\n     , "quadrillion"\n     , "quintillion"\n     , "sextillion"\n     , "septillion"\n     , "octillion"\n     , "nonillion"\n     , "decillion"\n     , "undecillion"\n     , "duodecillion"\n     , "tredecillion"\n     , "quattuordecillion"\n     , "quindecillion"\n     , "sexdecillion"\n     , "septendecillion"\n     , "octodecillion"\n     , "novemdecillion"\n     ] ++ lift2 ((++) =<<) preillion postillion\n\n-- A data type representing the digits zero to nine.\ndata Digit =\n  Zero\n  | One\n  | Two\n  | Three\n  | Four\n  | Five\n  | Six\n  | Seven\n  | Eight\n  | Nine\n  deriving (Eq, Ord)\n\nshowDigit ::\n  Digit\n  -> Chars\nshowDigit Zero =\n  "zero"\nshowDigit One =\n  "one"\nshowDigit Two =\n  "two"\nshowDigit Three =\n  "three"\nshowDigit Four =\n  "four"\nshowDigit Five =\n  "five"\nshowDigit Six =\n  "six"\nshowDigit Seven =\n  "seven"\nshowDigit Eight =\n  "eight"\nshowDigit Nine =\n  "nine"\n\n-- A data type representing one, two or three digits, which may be useful for grouping.\ndata Digit3 =\n  D1 Digit\n  | D2 Digit Digit\n  | D3 Digit Digit Digit\n  deriving Eq\n\n-- Possibly convert a character to a digit.\nfromChar ::\n  Char\n  -> Optional Digit\nfromChar \'0\' =\n  Full Zero\nfromChar \'1\' =\n  Full One\nfromChar \'2\' =\n  Full Two\nfromChar \'3\' =\n  Full Three\nfromChar \'4\' =\n  Full Four\nfromChar \'5\' =\n  Full Five\nfromChar \'6\' =\n  Full Six\nfromChar \'7\' =\n  Full Seven\nfromChar \'8\' =\n  Full Eight\nfromChar \'9\' =\n  Full Nine\nfromChar _ =\n  Empty\n\n-- | Take a numeric value and produce its English output.\n--\n-- >>> dollars "0"\n-- "zero dollars and zero cents"\n--\n-- >>> dollars "1"\n-- "one dollar and zero cents"\n--\n-- >>> dollars "0.1"\n-- "zero dollars and ten cents"\n--\n-- >>> dollars "1."\n-- "one dollar and zero cents"\n--\n-- >>> dollars "0."\n-- "zero dollars and zero cents"\n--\n-- >>> dollars "0.0"\n-- "zero dollars and zero cents"\n--\n-- >>> dollars ".34"\n-- "zero dollars and thirty-four cents"\n--\n-- >>> dollars "0.3456789"\n-- "zero dollars and thirty-four cents"\n--\n-- >>> dollars "1.0"\n-- "one dollar and zero cents"\n--\n-- >>> dollars "1.01"\n-- "one dollar and one cent"\n--\n-- >>> dollars "a1a"\n-- "one dollar and zero cents"\n--\n-- >>> dollars "a1a.a0.7b"\n-- "one dollar and seven cents"\n--\n-- >>> dollars "100"\n-- "one hundred dollars and zero cents"\n--\n-- >>> dollars "100.0"\n-- "one hundred dollars and zero cents"\n--\n-- >>> dollars "100.00"\n-- "one hundred dollars and zero cents"\n--\n-- >>> dollars "100.00000"\n-- "one hundred dollars and zero cents"\n--\n-- >>> dollars "1000456.13"\n-- "one million four hundred and fifty-six dollars and thirteen cents"\n--\n-- >>> dollars "1001456.13"\n-- "one million one thousand four hundred and fifty-six dollars and thirteen cents"\n--\n-- >>> dollars "16000000456.13"\n-- "sixteen billion four hundred and fifty-six dollars and thirteen cents"\n--\n-- >>> dollars "100.45"\n-- "one hundred dollars and forty-five cents"\n--\n-- >>> dollars "100.07"\n-- "one hundred dollars and seven cents"\n--\n-- >>> dollars "9abc9def9ghi.jkl9mno"\n-- "nine hundred and ninety-nine dollars and ninety cents"\n--\n-- >>> dollars "12345.67"\n-- "twelve thousand three hundred and forty-five dollars and sixty-seven cents"\n--\n-- >>> dollars "456789123456789012345678901234567890123456789012345678901234567890.12"\n-- "four hundred and fifty-six vigintillion seven hundred and eighty-nine novemdecillion one hundred and twenty-three octodecillion four hundred and fifty-six septendecillion seven hundred and eighty-nine sexdecillion twelve quindecillion three hundred and forty-five quattuordecillion six hundred and seventy-eight tredecillion nine hundred and one duodecillion two hundred and thirty-four undecillion five hundred and sixty-seven decillion eight hundred and ninety nonillion one hundred and twenty-three octillion four hundred and fifty-six septillion seven hundred and eighty-nine sextillion twelve quintillion three hundred and forty-five quadrillion six hundred and seventy-eight trillion nine hundred and one billion two hundred and thirty-four million five hundred and sixty-seven thousand eight hundred and ninety dollars and twelve cents"\ndollars ::\n  Chars\n  -> Chars\ndollars =\n  error "todo: Course.Cheque#dollars"\n'