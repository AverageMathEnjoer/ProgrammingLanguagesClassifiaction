b'//  $Header$\nusing System;\nusing System.Collections.Generic;\nusing System.Text;\nusing CS_SQLite3;\nusing System.Data;\nusing System.Collections;\n\nnamespace CS_SQLite3\n{\n\n  using sqlite = CSSQLite.sqlite3;\n  using Vdbe = CSSQLite.Vdbe;\n\n  /// <summary>\n  /// C#-SQLite wrapper with functions for opening, closing and executing queries.\n  /// </summary>\n  public class SQLiteVdbe\n  {\n    private Vdbe vm = null;\n    private string LastError = "";\n    private int LastResult = 0;\n\n    /// <summary>\n    /// Creates new instance of SQLiteVdbe class by compiling a statement\n    /// </summary>\n    /// <param name="query"></param>\n    /// <returns>Vdbe</returns>\n    public SQLiteVdbe( SQLiteDatabase db, String query )\n    {\n      vm = null;\n\n      // prepare and compile \n      CSSQLite.sqlite3_prepare_v2( db.Connection(), query, query.Length, ref vm, 0 );\n    }\n\n    /// <summary>\n    /// Return Virtual Machine Pointer\n    /// </summary>\n    /// <param name="query"></param>\n    /// <returns>Vdbe</returns>\n    public Vdbe VirtualMachine()\n    {\n      return vm;\n    }\n    \n    /// <summary>\n    /// <summary>\n    /// BindInteger\n    /// </summary>\n    /// <param name="index"></param>\n    /// <param name="bInteger"></param>\n    /// <returns>LastResult</returns>\n    public int BindInteger(int index, int bInteger )\n    {\n      if ( (LastResult = CSSQLite.sqlite3_bind_int( vm, index, bInteger ))== CSSQLite.SQLITE_OK )\n      { LastError = ""; }\n      else\n      {\n        LastError = "Error " + LastError + "binding Integer [" + bInteger + "]";\n      }\n      return LastResult;\n    }\n\n    /// <summary>\n    /// <summary>\n    /// BindLong\n    /// </summary>\n    /// <param name="index"></param>\n    /// <param name="bLong"></param>\n    /// <returns>LastResult</returns>\n    public int BindLong( int index, long bLong )\n    {\n      if ( ( LastResult = CSSQLite.sqlite3_bind_int64( vm, index, bLong ) ) == CSSQLite.SQLITE_OK )\n      { LastError = ""; }\n      else\n      {\n        LastError = "Error " + LastError + "binding Long [" + bLong + "]";\n      }\n      return LastResult;\n    }\n\n    /// <summary>\n    /// BindText\n    /// </summary>\n    /// <param name="index"></param>\n    /// <param name="bLong"></param>\n    /// <returns>LastResult</returns>\n    public int BindText(  int index, string bText )\n    {\n      if ( ( LastResult = CSSQLite.sqlite3_bind_text( vm, index, bText ,-1,null) ) == CSSQLite.SQLITE_OK )\n      { LastError = ""; }\n      else\n      {\n        LastError = "Error " + LastError + "binding Text [" + bText + "]";\n      }\n      return LastResult;\n    }\n\n    /// <summary>\n    /// Execute statement\n    /// </summary>\n    /// </param>\n    /// <returns>LastResult</returns>\n    public int ExecuteStep(   )\n    {\n      // Execute the statement\n      int LastResult = CSSQLite.sqlite3_step( vm );\n\n      return LastResult;\n    }\n\n    /// <summary>\n    /// Returns Result column as Long\n    /// </summary>\n    /// </param>\n    /// <returns>Result column</returns>\n    public long Result_Long(int index)\n    {\n      return CSSQLite.sqlite3_column_int64( vm, index );\n    }\n\n    /// <summary>\n    /// Returns Result column as Text\n    /// </summary>\n    /// </param>\n    /// <returns>Result column</returns>\n    public string Result_Text( int index )\n    {\n      return CSSQLite.sqlite3_column_text( vm, index );\n    }\n\n    \n    /// <summary>\n    /// Returns Count of Result Rows\n    /// </summary>\n    /// </param>\n    /// <returns>Count of Results</returns>\n    public int ResultColumnCount( )\n    {\n      return vm.pResultSet == null ? 0 : vm.pResultSet.Length;\n    }\n\n    /// <summary>\n    /// Reset statement\n    /// </summary>\n    /// </param>\n    /// </returns>\n    public void Reset()\n    {\n      // Reset the statment so it\'s ready to use again\n      CSSQLite.sqlite3_reset( vm );\n    }\n    \n    /// <summary>\n    /// Closes statement\n    /// </summary>\n    /// </param>\n    /// <returns>LastResult</returns>\n    public void Close()\n    {\n      CSSQLite.sqlite3_finalize( ref vm );\n    }\n  \n  }\n}\n'