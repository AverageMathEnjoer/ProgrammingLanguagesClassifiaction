b'#\' aggconfusion\n#\'\n#\' Aggregate confusion tables from separate runs of fastLink() (UNDER DEVELOPMENT)\n#\'\n#\' @usage aggconfusion(object)\n#\'\n#\' @param object A list of confusion tables. \n#\'\n#\' @return \'aggconfusion()\' returns two tables - one calculating the confusion table, and another\n#\' calculating a series of additional summary statistics.\n#\'\n#\' @author Ted Enamorado <ted.enamorado@gmail.com> and Ben Fifield <benfifield@gmail.com>\n#\'\n#\' @export\naggconfusion <- function(object) {\n  y <- unlist(object)\n  \n  D <- sum(y[grep("confusion.table1", names(y))])\n  B <- sum(y[grep("confusion.table2", names(y))])\n  C <- sum(y[grep("confusion.table3", names(y))])\n  A <- sum(y[grep("confusion.table4", names(y))])\n  \n  t1 <- round(rbind(c(D, B), c(C, A)), 2)\n  colnames(t1) <- c("\'True\' Matches", "\'True\' Non-Matches")\n  rownames(t1) <- c("Declared Matches", "Declared Non-Matches")\n  N = A + B + C + D\n  sens = 100 * D/(C + D)\n  spec = 100 * A/(A + B)\n  ppv = 100 * D/(B + D)\n  npv = 100 * A/(A + C)\n  fpr = 100 * B/(A + B)\n  fnr = 100 * C/(C + D)\n  acc = 100 * (A + D)/N\n  f1 = (2 * ppv * sens)/(ppv + sens)\n  t2 <- round(as.matrix(c(N, sens, spec, ppv, npv, fpr, fnr, \n                          acc, f1)), digits = 4)\n  rownames(t2) <- c("Max Number of Obs to be Matched", "Sensitivity (%)", \n                    "Specificity (%)", "Positive Predicted Value (%)", "Negative Predicted Value (%)", \n                    "False Positive Rate (%)", "False Negative Rate (%)", \n                    "Correctly Clasified (%)", "F1 Score (%)")\n  colnames(t2) <- "results"\n  results <- list()\n  results$confusion.table <- t1\n  options(digits = 6)\n  results$addition.info <- round(t2, digits = 2)\n  return(results)\n}\n\n\n'