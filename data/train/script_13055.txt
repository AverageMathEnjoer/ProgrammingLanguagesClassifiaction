b'\xef\xbb\xbf// UVa512 Spreadsheet Tracking (\xe7\xae\x97\xe6\xb3\x951)\n// Rujia Liu\n#include<stdio.h>\n#include<string.h>\n#define maxd 100\n#define BIG 10000\nint r, c, n, d[maxd][maxd], d2[maxd][maxd], ans[maxd][maxd], cols[maxd];\n\nvoid copy(char type, int p, int q) {\n  if(type == \'R\') {\n    for(int i = 1; i <= c; i++)\n      d[p][i] = d2[q][i];\n  } else {\n    for(int i = 1; i <= r; i++)\n      d[i][p] = d2[i][q];\n  }\n}\n\nvoid del(char type) {\n  memcpy(d2, d, sizeof(d));\n  int cnt = type == \'R\' ? r : c, cnt2 = 0;\n  for(int i = 1; i <= cnt; i++) {\n    if(!cols[i]) copy(type, ++cnt2, i);\n  }\n  if(type == \'R\') r = cnt2; else c = cnt2;\n}\n\nvoid ins(char type) {\n  memcpy(d2, d, sizeof(d));\n  int cnt = type == \'R\' ? r : c, cnt2 = 0;\n  for(int i = 1; i <= cnt; i++) {\n    if(cols[i]) copy(type, ++cnt2, 0);\n    copy(type, ++cnt2, i);\n  }\n  if(type == \'R\') r = cnt2; else c = cnt2;\n}\n\nint main() {\n  int r1, c1, r2, c2, q, kase = 0;\n  char cmd[10];\n  memset(d, 0, sizeof(d));\n  while(scanf("%d%d%d", &r, &c, &n) == 3 && r) {\n    int r0 = r, c0 = c;\n    for(int i = 1; i <= r; i++)\n      for(int j = 1; j <= c; j++)\n        d[i][j] = i*BIG + j;\n    while(n--) {\n      scanf("%s", cmd);\n      if(cmd[0] == \'E\') {\n        scanf("%d%d%d%d", &r1, &c1, &r2, &c2);\n        int t = d[r1][c1]; d[r1][c1] = d[r2][c2]; d[r2][c2] = t;\n      } else {\n        int a, x;\n        scanf("%d", &a);\n        memset(cols, 0, sizeof(cols));\n        for(int i = 0; i < a; i++) { scanf("%d", &x); cols[x] = 1; }\n        if(cmd[0] == \'D\') del(cmd[1]); else ins(cmd[1]);\n      }\n    }\n    memset(ans, 0, sizeof(ans));\n    for(int i = 1; i <= r; i++)\n      for(int j = 1; j <= c; j++) {\n        ans[d[i][j]/BIG][d[i][j]%BIG] = i*BIG+j;\n      }\n    if(kase > 0) printf("\\n");\n    printf("Spreadsheet #%d\\n", ++kase);\n\n    scanf("%d", &q);\n    while(q--) {\n      scanf("%d%d", &r1, &c1);\n      printf("Cell data in (%d,%d) ", r1, c1);\n      if(ans[r1][c1] == 0) printf("GONE\\n");\n      else printf("moved to (%d,%d)\\n", ans[r1][c1]/BIG, ans[r1][c1]%BIG);\n    }\n  }\n  return 0;\n}\n'