b'import Data.Array\n\nsmallest :: Ord a => Int -> (Array Int a, Array Int a) -> a\nsmallest k (xa, ya) = search k (0, m + 1) (0, n + 1)\n    where (0, m) = bounds xa\n          (0, n) = bounds ya\n          search k (lx, rx) (ly,  ry)\n            | lx == rx  = ya!(ly + k)\n            | ly == ry  = xa!(lx + k)\n            | otherwise = case (xa!mx < ya!my, k <= mx + my - lx - ly) of\n                    (True, True)   -> search k (lx, rx) (ly, my)\n                    (True, False)  -> search (k - mx - 1 + lx) (mx + 1, rx) (ly, ry)\n                    (False, True)  -> search k (lx, mx) (ly, ry)\n                    (False, False) -> search (k - my - 1 + ly) (lx, rx) (my + 1, ry)\n            where mx = (lx + rx) `div` 2\n                  my = (ly + ry) `div` 2\n'