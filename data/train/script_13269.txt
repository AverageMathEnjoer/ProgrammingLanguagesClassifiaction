b'\xef\xbb\xbfusing System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Linq;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\nnamespace Rubeus.lib.Interop\n{\n    public class NtException : Exception\n    {\n        [DllImport("ntdll.dll")]\n        public static extern int RtlNtStatusToDosError(int status);\n\n        internal const int ERROR_MR_MID_NOT_FOUND = 317;\n\n        public NtException(int errorCode): base(GetErrorMessage(errorCode))\n        {\n        }\n\n        private static string GetErrorMessage(int errorCode)\n        {\n            if (Rubeus.Interop.LsaNtStatusToWinError((uint)errorCode) == ERROR_MR_MID_NOT_FOUND)\n            {\n                return $"NTSTAUTS error code 0x{errorCode.ToString("X")}";\n            }\n            else\n            {\n                return $"NTSTATUS error code 0x{errorCode.ToString("X")}: " + (new Win32Exception(errorCode)).Message;\n            }\n        }\n    }\n}\n'